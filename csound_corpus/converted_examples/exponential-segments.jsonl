{"instruction": "Write a Csound instrument for SIMULATED PULSE WIDTH MODULATION using exponential segments", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac -d\n</CsOptions>\n<CsInstruments>\n; Converted from pw.orc and pw.sco\n; Original files preserved in same directory\n\nsr\t\t=\t\t44100\nkr\t\t=\t\t4410\nksmps\t=\t\t10\nnchnls\t=\t\t1\n\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n;;;copyright 1998 Paul M. Winkler, zarmzarm@erols.com\n;****++++\n;**** Last modified: Wed Dec\t9 20:32:30 1998\n;****----\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\n\n\t   instr 1\n;SIMULATED PULSE WIDTH MODULATION\n\n;THIS WORKS! BUT P5 SHOULD BE HANDLED BETTER.\nipitch \t= \t\tcpspch (p4)\naindex   \tphasor    ipitch\n\n; MAKE THE WIDTH (P5) 'FEEL' A LITTLE NICER -- AN EXPONENTIAL CURVE FROM \n; FTLEN/2 TO FTLEN, CONTROLLED BY A LINEAR PERCENTAGE (0 TO 100).\n; THIS IS NOT GREAT: P5 LESS THAN ABOUT 10 IS TOO SMALL!\n\nilength \t= \t\tftlen(1) \ninum \t= \t\tp5 * p5 * .0001 ; normalize it to 0 - 1\n\n; POW WOULD BE A BETTER SOLUTION, BUT IT'S BROKEN IN MY CSOUND VERSION?\n\nirange \t= \t\t( ilength + ( inum * ilength )) * .5\naindex\t= \t\taindex * irange\nprint irange\n; DISPLAY\t  AINDEX, .1\t\t\t\t\t    \n\t\taout\t  table\t\t  aindex, 1;  use f1\n\t\tout aout \n\t\t  endin \n\n\t\t  instr 2\n; Same thing, only pulse width is controlled by an envelope.\nipitch = cpspch (p4)\naindex   phasor    ipitch\nilength = ftlen(1) \nkrange   expseg  ilength * .5, p3 * .5, ilength, p3 * .5, ilength * .5\naindex = aindex * krange\naout\t  table\t\t  aindex, 1;  table 1\nout aout \n\t\t  endin\n\n</CsInstruments>\n<CsScore>\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n;;COPYRIGHT 1998 PAUL M. WINKLER, ZARMZARM@EROLS.COM\n;****++++\n;**** LAST MODIFIED: WED DEC  9 20:34:05 1998\n;****----\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\nf1 0  512  -7   30000 256 30000 0 -30000 256 -30000 ;square wave, !normalized\n\n;  AT DUR PCH    WIDTH     \n\nt 0 180\ni1 0  1   6.00   100\ni. +  .5  6.02   100\ni. .  .    .     50\ni. .  .   6.03   50 \ni. .  .   6.00   10 \ni. .  .   6.01   10  \ni. .  .   6.10   10\ni. .  .   7.10   20   \ni. .  .   7.08   .\ni. .  .   7.07   40\ni. .  .   6.07   .\ni. .  .   5.07   60\ni. .  .   4.07   .\ni. .  .   5.07   80\ni. .  .   4.07   . \ni. .  .   5.07   100 \ni. .  .   4.07    >\ni. .  2   5.07   30\n\ns\nt 0 120\ni2 1 3   5.00\ni2 + 3   5.11\ni2 . 3   6.10\ni2 . 3   7.09\ni2 . 3   8.08\ni2 . 3   9.07\ni2 . 3   10.06\ni2 . 3   11.05     ; QUITE BAD ALIASING THERE!\n\n</CsScore>\n</CsoundSynthesizer>"}
