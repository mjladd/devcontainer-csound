{"instruction": "Write a CSound instrument that demonstrates stereo enhancement opcodes: freeverb, reverbsc for width, stereomix, mirror", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ninstr 1\n    ; freeverb opcode: aoutL, aoutR freeverb ainL, ainR, kRoomSize, kHFDamp [, iSRate, iSkip]\n    ; Stereo reverb for width enhancement\n    ; kRoomSize - room size (0-1)\n    ; kHFDamp - high-frequency damping (0-1)\n    \n    ; Mono source\n    aIn oscili 0.3, 440, -1\n    \n    ; Freeverb for stereo width\n    kRoomSize = 0.7\n    kHFDamp = 0.5\n    \n    aRevL, aRevR freeverb aIn, aIn, kRoomSize, kHFDamp\n    \n    ; Mix dry and wet\n    aOutL = aIn*0.6 + aRevL*0.4\n    aOutR = aIn*0.6 + aRevR*0.4\n    \n    outs aOutL, aOutR\nendin\n\ninstr 2\n    ; reverbsc opcode: aoutL, aoutR reverbsc ainL, ainR, kfblvl, kfco [, israte, ipitchm, iskip]\n    ; Sean Costello reverb for stereo enhancement\n    ; kfblvl - feedback level (0-1)\n    ; kfco - cutoff frequency\n    \n    aIn vco2 0.3, 330, 10\n    \n    ; Reverbsc for width\n    kFeedback linseg 0.7, p3*0.5, 0.9, p3*0.5, 0.75\n    kCutoff = 8000\n    \n    aRevL, aRevR reverbsc aIn, aIn, kFeedback, kCutoff\n    \n    aOutL = aIn*0.5 + aRevL*0.5\n    aOutR = aIn*0.5 + aRevR*0.5\n    \n    outs aOutL, aOutR\nendin\n\ninstr 3\n    ; Stereo width control\n    ; M-S processing for enhancement\n    \n    ; Stereo source\n    aL oscili 0.3, 440, -1\n    aR vco2 0.3, 550, 10\n    \n    ; Convert to mid-side\n    aMid = (aL + aR) * 0.5\n    aSide = (aL - aR) * 0.5\n    \n    ; Enhance width by boosting side\n    kWidth linseg 1, p3*0.5, 3, p3*0.5, 1\n    aSideEnh = aSide * kWidth\n    \n    ; Convert back to L-R\n    aOutL = aMid + aSideEnh\n    aOutR = aMid - aSideEnh\n    \n    outs aOutL, aOutR\nendin\n\ninstr 4\n    ; mirror opcode simulation\n    ; Reflect left/right channels\n    \n    aL oscili 0.3, 330, -1\n    aR vco2 0.3, 440, 10\n    \n    ; Crossfade to mirrored version\n    kMirror linseg 0, p3*0.5, 1, p3*0.5, 0\n    \n    aOutL = aL*(1-kMirror) + aR*kMirror\n    aOutR = aR*(1-kMirror) + aL*kMirror\n    \n    outs aOutL, aOutR\nendin\n\ninstr 5\n    ; Haas effect for width\n    ; Short delay for stereo enhancement\n    \n    aIn buzz 0.3, 220, 20, -1\n    \n    ; Delays\n    aDelL delayr 0.05\n    aTapL deltapi 0.015\n          delayw aIn\n    \n    aDelR delayr 0.05\n    aTapR deltapi 0.021\n          delayw aIn\n    \n    ; Mix\n    aOutL = aIn*0.6 + aTapL*0.4\n    aOutR = aIn*0.6 + aTapR*0.4\n    \n    outs aOutL, aOutR\nendin\n\ninstr 6\n    ; Combined stereo enhancement\n    ; Reverb + width + Haas effect\n    \n    aIn vco2 0.3, 165, 0\n    \n    ; Reverb for ambience\n    kRoom = 0.6\n    kDamp = 0.6\n    aRevL, aRevR freeverb aIn, aIn, kRoom, kDamp\n    \n    ; Haas delay\n    aDelL delayr 0.03\n    aTapL deltapi 0.012\n          delayw aIn + aRevL*0.3\n    \n    aDelR delayr 0.03\n    aTapR deltapi 0.018\n          delayw aIn + aRevR*0.3\n    \n    ; M-S width enhancement\n    aMid = (aTapL + aTapR) * 0.5\n    aSide = (aTapL - aTapR) * 0.5\n    aSideEnh = aSide * 1.5\n    \n    aOutL = aMid + aSideEnh\n    aOutR = aMid - aSideEnh\n    \n    outs aOutL*0.8, aOutR*0.8\nendin\n\n</CsInstruments>\n<CsScore>\n\ni1 0 4\ni2 5 4\ni3 10 4\ni4 15 3\ni5 19 3\ni6 23 5\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
