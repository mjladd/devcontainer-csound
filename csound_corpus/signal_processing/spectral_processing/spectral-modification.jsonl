{"instruction": "Write a CSound instrument that demonstrates spectral modification opcodes: pvscale, pvshift, pvsblur, pvsmix", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ninstr 1\n    ; pvscale opcode: fsig pvscale fsigin, kscale [, kkeepform, kgain, kcoefs]\n    ; Time-independent pitch scaling\n    ; kscale - scaling factor (2 = up octave, 0.5 = down octave)\n    ; kkeepform - formant preservation (0 or 1)\n    \n    aIn vco2 0.3, 220, 0\n    \n    ; Analyze\n    fsig pvsanal aIn, 1024, 256, 1024, 1\n    \n    ; Scale pitch\n    kScale linseg 1, p3*0.5, 2, p3*0.5, 0.5\n    fscaled pvscale fsig, kScale\n    \n    ; Synthesize\n    aOut pvsynth fscaled\n    \n    outs aIn*0.4, aOut*0.6\nendin\n\ninstr 2\n    ; pvshift opcode: fsig pvshift fsigin, kshift, klowest [, kkeepform, kgain, kcoefs]\n    ; Frequency shifting (additive, not multiplicative)\n    ; kshift - frequency shift in Hz\n    ; klowest - lowest frequency to shift\n    \n    aIn buzz 0.3, 165, 25, -1\n    \n    ; Analyze\n    fsig pvsanal aIn, 1024, 256, 1024, 1\n    \n    ; Shift frequencies\n    kShift linseg 0, p3*0.5, 300, p3*0.5, -200\n    fshifted pvshift fsig, kShift, 50\n    \n    ; Synthesize\n    aOut pvsynth fshifted\n    \n    outs aIn*0.4, aOut*0.6\nendin\n\ninstr 3\n    ; pvsblur opcode: fsig pvsblur fsigin, kblurtime, imaxdel\n    ; Spectral blurring/smearing\n    ; kblurtime - blur time (seconds)\n    ; imaxdel - maximum delay time\n    \n    aIn vco2 0.3, 330, 10\n    aIn *= linseg(1, 0.1, 0.5, 0.2, 1, p3-0.3, 0.5)\n    \n    ; Analyze\n    fsig pvsanal aIn, 1024, 256, 1024, 1\n    \n    ; Apply blur\n    kBlur linseg 0, p3*0.3, 0.5, p3*0.4, 0.5, p3*0.3, 0\n    fblurred pvsblur fsig, kBlur, 1\n    \n    ; Synthesize\n    aOut pvsynth fblurred\n    \n    outs aIn*0.4, aOut*0.6\nendin\n\ninstr 4\n    ; pvsmix opcode: fsig pvsmix fsig1, fsig2\n    ; Mix two spectra\n    \n    ; Two sources\n    aIn1 oscili 0.25, 220, -1\n    aIn2 buzz 0.25, 330, 15, -1\n    \n    ; Analyze both\n    fsig1 pvsanal aIn1, 1024, 256, 1024, 1\n    fsig2 pvsanal aIn2, 1024, 256, 1024, 1\n    \n    ; Mix spectra\n    fmixed pvsmix fsig1, fsig2\n    \n    ; Synthesize\n    aOut pvsynth fmixed\n    \n    outs aOut, aOut\nendin\n\ninstr 5\n    ; Combined spectral modifications\n    aIn vco2 0.3, 165, 0\n    \n    ; Analyze\n    fsig pvsanal aIn, 2048, 512, 2048, 1\n    \n    ; Scale up an octave\n    fscaled pvscale fsig, 2\n    \n    ; Shift down by 100 Hz\n    fshifted pvshift fscaled, -100, 50\n    \n    ; Add blur\n    fblurred pvsblur fshifted, 0.2, 1\n    \n    ; Synthesize\n    aOut pvsynth fblurred\n    \n    outs aIn*0.3, aOut*0.7\nendin\n\ninstr 6\n    ; Formant preservation with scaling\n    aIn buzz 0.3, 110, 40, -1\n    \n    ; Analyze\n    fsig pvsanal aIn, 1024, 256, 1024, 1\n    \n    ; Scale pitch with formant preservation\n    kScale linseg 1, p3, 3\n    fscaled pvscale fsig, kScale, 1  ; keepform = 1\n    \n    ; Synthesize\n    aOut pvsynth fscaled\n    \n    outs aIn*0.4, aOut*0.6\nendin\n\n</CsInstruments>\n<CsScore>\n\ni1 0 4\ni2 5 4\ni3 10 4\ni4 15 3\ni5 19 4\ni6 24 5\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
