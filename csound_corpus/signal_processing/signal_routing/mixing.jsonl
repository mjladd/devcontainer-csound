{"instruction": "Write a CSound instrument that demonstrates audio mixing opcodes: sum, product, diff, and manual mixing", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Global audio buses\nga1 init 0\nga2 init 0\nga3 init 0\n\ninstr 1\n    ; Basic manual mixing\n    ; Multiple oscillators mixed together\n    \n    aOsc1 oscili 0.15, 220, -1\n    aOsc2 oscili 0.15, 330, -1\n    aOsc3 oscili 0.15, 440, -1\n    aOsc4 oscili 0.15, 550, -1\n    \n    ; Simple sum\n    aMix = aOsc1 + aOsc2 + aOsc3 + aOsc4\n    \n    ; Scale to prevent clipping\n    aMix *= 0.5\n    \n    outs aMix, aMix\nendin\n\ninstr 2\n    ; Weighted mixing with envelopes\n    aOsc1 vco2 0.2, 165, 0\n    aOsc2 vco2 0.2, 220, 10\n    aOsc3 buzz 0.2, 110, 15, -1\n    \n    ; Time-varying mix levels\n    kMix1 linseg 1, p3*0.33, 0.3, p3*0.33, 0.8, p3*0.34, 0.5\n    kMix2 linseg 0.5, p3*0.33, 1, p3*0.33, 0.4, p3*0.34, 0.7\n    kMix3 linseg 0.7, p3*0.33, 0.6, p3*0.33, 1, p3*0.34, 0.6\n    \n    ; Weighted mix\n    aMix = (aOsc1*kMix1 + aOsc2*kMix2 + aOsc3*kMix3) * 0.4\n    \n    outs aMix, aMix\nendin\n\ninstr 3\n    ; sum opcode: aout sum ain1, ain2, ain3, ...\n    ; Explicit sum of multiple signals\n    \n    aSaw vco2 0.15, 220, 0\n    aSq vco2 0.15, 220, 2, 0.5\n    aTri vco2 0.15, 220, 10\n    aSine oscili 0.15, 220, -1\n    \n    ; Sum all waveforms\n    aMix sum aSaw, aSq, aTri, aSine\n    \n    ; Normalize\n    aMix *= 0.4\n    \n    outs aMix, aMix\nendin\n\ninstr 4\n    ; Product mixing (ring modulation)\n    ; product opcode: aout product ain1, ain2\n    \n    aCarrier oscili 0.5, 440, -1\n    kModFreq linseg 20, p3, 200\n    aModulator oscili 1, kModFreq, -1\n    \n    ; Multiply signals\n    aRM product aCarrier, aModulator\n    \n    outs aCarrier*0.3, aRM*0.5\nendin\n\ninstr 5\n    ; diff opcode: aout diff ain1, ain2\n    ; Difference between signals\n    \n    aOsc1 oscili 0.3, 220, -1\n    aOsc2 oscili 0.3, 225, -1  ; Slightly detuned\n    \n    ; Difference creates beating effect\n    aDiff diff aOsc1, aOsc2\n    \n    ; Sum for comparison\n    aSum = aOsc1 + aOsc2\n    \n    outs aSum*0.3, aDiff*0.5\nendin\n\ninstr 6\n    ; Bus mixing with global audio\n    ; Send to buses\n    aOsc1 oscili 0.2, 330, -1\n    aOsc2 vco2 0.2, 440, 10\n    \n    ; Send to global buses\n    ga1 = ga1 + aOsc1*0.7\n    ga2 = ga2 + aOsc2*0.5\n    ga3 = ga3 + (aOsc1+aOsc2)*0.3\nendin\n\ninstr 7\n    ; Master mixer - reads from buses\n    \n    ; Mix buses\n    aMix = ga1 + ga2*0.8 + ga3*0.6\n    \n    ; Apply master processing\n    aMix butterlp aMix, 3000\n    aMix *= 0.8\n    \n    outs aMix, aMix\n    \n    ; Clear buses\n    ga1 = 0\n    ga2 = 0\n    ga3 = 0\nendin\n\ninstr 8\n    ; Parallel processing mix\n    aIn vco2 0.3, 220, 0\n    \n    ; Process in parallel\n    aDry = aIn\n    aLP butterlp aIn, 800\n    aHP butterhp aIn, 2000\n    aBP butterbp aIn, 1200, 400\n    \n    ; Mix parallel chains\n    aMix = aDry*0.3 + aLP*0.4 + aHP*0.2 + aBP*0.3\n    \n    outs aMix, aMix\nendin\n\n</CsInstruments>\n<CsScore>\n\ni1 0 2\ni2 3 3\ni3 7 2\ni4 10 3\ni5 14 3\n\n; Bus mixing example\ni6 18 2\ni7 18 2.5\n\ni8 22 3\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
