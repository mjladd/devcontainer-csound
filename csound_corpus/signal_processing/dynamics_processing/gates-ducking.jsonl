{"instruction": "Write a CSound instrument that demonstrates gates and ducking with compress2 and hvs1 opcodes", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ninstr 1\n    ; compress2 as expander/gate\n    ; Use very low ratio for expansion, high for compression\n    \n    kAmp madsr 0.01, 0.1, 0.7, 0.2\n    \n    ; Noisy signal\n    aOsc oscili kAmp*0.3, 440, -1, 0\n    aNoise noise kAmp*0.05, 0\n    aSig = aOsc + aNoise\n    \n    ; Gate: expand below threshold (ratio < 1)\n    kThresh = -30\n    kLoKnee = 0\n    kHiKnee = 5\n    kRatio = 0.2  ; < 1 = expansion/gate\n    kAtt = 0.001\n    kRel = 0.05\n    iLook = 0.005\n    \n    aGate compress2 aSig, aSig, kThresh, kLoKnee, kHiKnee, kRatio, kAtt, kRel, iLook\n    \n    outs aGate, aGate\nendin\n\ninstr 2\n    ; Side-chain ducking with compress2\n    ; Main signal\n    kAmp1 madsr 0.015, 0.08, 0.65, 0.25\n    aMain oscili kAmp1*0.3, 330, -1, 0\n    \n    ; Side-chain (kick drum simulation)\n    kAmp2 madsr 0.005, 0.02, 0.1, 0.08\n    aSC oscili kAmp2*0.6, 60, -1, 0\n    \n    ; Use side-chain as control\n    kThresh = -25\n    kRatio = 8\n    kAtt = 0.001\n    kRel = 0.15\n    \n    aDucked compress2 aMain, aSC, kThresh, 0, 5, kRatio, kAtt, kRel, 0.005\n    \n    ; Mix with side-chain\n    aMix = aDucked + aSC*0.8\n    \n    outs aMix, aMix\nendin\n\ninstr 3\n    ; hvs1 opcode: hvs1 asig, katt, krel, istor\n    ; Half-wave rectifier with smoothing (envelope follower)\n    ; asig - input signal\n    ; katt - attack time (seconds)\n    ; krel - release time (seconds)\n    ; istor - skip initialization\n    \n    kAmp madsr 0.02, 0.12, 0.6, 0.3\n    \n    ; Pulse wave\n    aPulse vco2 kAmp*0.3, 220, 2, 0.4\n    \n    ; Extract envelope with hvs1\n    kAtt = 0.005\n    kRel = 0.1\n    aEnv hvs1 aPulse, kAtt, kRel, 0\n    \n    ; Use envelope to modulate frequency\n    aOsc oscili kAmp*0.3, 440 + aEnv*200, -1, 0\n    \n    outs aOsc, aOsc\nendin\n\ninstr 4\n    ; Gate with fast attack, slow release\n    kAmp madsr 0.01, 0.1, 0.7, 0.2\n    \n    ; Impulse train with noise\n    aImp mpulse kAmp*0.5, 1.5\n    aNoise noise kAmp*0.1, 0\n    aSig = aImp + aNoise\n    \n    ; Aggressive gate\n    kThresh = -35\n    kRatio = 0.1  ; Strong expansion\n    kAtt = 0.0005\n    kRel = 0.2\n    \n    aGate compress2 aSig, aSig, kThresh, 0, 3, kRatio, kAtt, kRel, 0.002\n    \n    outs aGate, aGate\nendin\n\ninstr 5\n    ; Rhythm gate effect\n    kAmp madsr 0.015, 0.08, 0.65, 0.25\n    \n    ; Sustained sound\n    aSaw vco2 kAmp*0.3, 110, 0\n    \n    ; Rhythmic control signal\n    aCtl vco2 kAmp*0.5, 4, 2, 0.3\n    \n    ; Use as gate control\n    kThresh = -20\n    kRatio = 0.3\n    kAtt = 0.001\n    kRel = 0.05\n    \n    aGated compress2 aSaw, aCtl, kThresh, 0, 5, kRatio, kAtt, kRel, 0.005\n    \n    outs aGated, aGated\nendin\n\n</CsInstruments>\n<CsScore>\n\ni1 0 4\ni2 4.5 5\ni3 10 4\ni4 14.5 4\ni5 19 5\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
