{"instruction": "Write a CSound instrument that demonstrates distortion and saturation opcodes: taninv, taninv2, clip", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ninstr 1\n    ; taninv opcode: ares taninv asig [, iscl]\n    ; Arctangent distortion\n    ; asig - input signal\n    ; iscl - scale factor (default 1)\n    \n    kAmp madsr 0.01, 0.1, 0.7, 0.2\n    \n    ; Clean sine\n    aOsc oscili kAmp*0.8, 220, -1, 0\n    \n    ; Light distortion\n    iScale = 2\n    aDist taninv aOsc, iScale\n    \n    outs aDist*0.5, aDist*0.5\nendin\n\ninstr 2\n    ; taninv2 opcode: ares taninv2 asig [, ka, kb]\n    ; Arctangent distortion with variable parameters\n    ; asig - input signal\n    ; ka, kb - distortion parameters (affect curve shape)\n    \n    kAmp madsr 0.015, 0.08, 0.65, 0.25\n    \n    ; Sawtooth\n    aSaw vco2 kAmp*0.6, 165, 0\n    \n    ; Dynamic distortion\n    ka linseg 1, p3*0.5, 5, p3*0.5, 2\n    kb = 0.5\n    \n    aDist taninv2 aSaw, ka, kb\n    \n    outs aDist*0.4, aDist*0.4\nendin\n\ninstr 3\n    ; Heavy taninv distortion\n    kAmp madsr 0.02, 0.12, 0.6, 0.3\n    \n    ; Pulse wave\n    aPulse vco2 kAmp*0.7, 110, 2, 0.4\n    \n    ; Heavy saturation\n    iScale = 8\n    aDist taninv aPulse, iScale\n    \n    ; Filter to smooth\n    aFilt butlp aDist, 3000\n    \n    outs aFilt*0.4, aFilt*0.4\nendin\n\ninstr 4\n    ; clip opcode for soft clipping: ares clip asig, ktype, klimit [, iarg]\n    ; Soft limiter/saturator\n    ; ktype: 0=Bram de Jong, 1=sine, 2=tanh\n    \n    kAmp madsr 0.01, 0.1, 0.7, 0.2\n    \n    ; Hot signal\n    aSaw vco2 kAmp*0.8, 220, 0\n    \n    ; Soft clip with tanh\n    kType = 2\n    kLimit = 0.4\n    \n    aClip clip aSaw, kType, kLimit\n    \n    outs aClip, aClip\nendin\n\ninstr 5\n    ; Sine waveshaping with clip\n    kAmp madsr 0.015, 0.08, 0.65, 0.25\n    \n    ; Square wave\n    aSq vco2 kAmp*0.7, 165, 2\n    \n    ; Sine waveshaping\n    kType = 1\n    kLimit = 0.5\n    \n    aShape clip aSq, kType, kLimit\n    \n    outs aShape*0.6, aShape*0.6\nendin\n\ninstr 6\n    ; Tube-style saturation with taninv2\n    kAmp madsr 0.02, 0.12, 0.6, 0.3\n    \n    ; Two detuned saws\n    aSaw1 vco2 kAmp*0.3, 110, 0\n    aSaw2 vco2 kAmp*0.3, 110.5, 0\n    aMix = aSaw1 + aSaw2\n    \n    ; Tube-like saturation\n    ka = 3\n    kb linseg 0.3, p3*0.5, 0.8, p3*0.5, 0.5\n    \n    aSat taninv2 aMix, ka, kb\n    \n    ; High-pass to remove DC\n    aOut buthp aSat, 20\n    \n    outs aOut*0.5, aOut*0.5\nendin\n\n</CsInstruments>\n<CsScore>\n\ni1 0 3\ni2 3.5 4\ni3 8 3\ni4 11.5 3\ni5 15 3\ni6 18.5 4\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
