{"instruction": "Write a CSound instrument that demonstrates phase manipulation opcodes: hilbert, hilbert2, phaser1, phaser2", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ninstr 1\n    ; hilbert opcode: ar1, ar2 hilbert asig\n    ; 90-degree phase difference (quadrature)\n    ; For single-sideband modulation and frequency shifting\n    \n    aIn oscili 0.3, 440, -1\n    \n    ; Generate quadrature pair\n    aReal, aImag hilbert aIn\n    \n    ; Frequency shifter\n    kShift = 200  ; Shift by 200 Hz\n    aShiftReal = aReal * cos(2*$M_PI*kShift*timeinstk()/sr)\n    aShiftImag = aImag * sin(2*$M_PI*kShift*timeinstk()/sr)\n    \n    ; Single sideband (USB)\n    aUSB = aShiftReal + aShiftImag\n    \n    ; Single sideband (LSB)\n    aLSB = aShiftReal - aShiftImag\n    \n    outs aIn*0.4, aUSB*0.6\nendin\n\ninstr 2\n    ; hilbert2 opcode: ar1, ar2 hilbert2 asig, ifftsize\n    ; FFT-based Hilbert transform (better quality)\n    \n    aIn vco2 0.3, 220, 0\n    \n    ; Generate quadrature\n    aReal, aImag hilbert2 aIn, 1024\n    \n    ; Dynamic frequency shift\n    kShift linseg -200, p3*0.5, 200, p3*0.5, 0\n    aShiftReal = aReal * cos(2*$M_PI*kShift*timeinstk()/sr)\n    aShiftImag = aImag * sin(2*$M_PI*kShift*timeinstk()/sr)\n    \n    aOut = aShiftReal + aShiftImag\n    \n    outs aIn*0.4, aOut*0.6\nendin\n\ninstr 3\n    ; Phase inversion and cancellation\n    ; Create phase-inverted signals\n    \n    aIn buzz 0.3, 330, 20, -1\n    \n    ; Original\n    aOrig = aIn\n    \n    ; 180-degree phase shift (inversion)\n    aInv = -aIn\n    \n    ; 90-degree phase shift\n    aReal, aImag hilbert aIn\n    a90 = aImag\n    \n    ; Output different phase relationships\n    kSelect linseg 0, p3*0.25, 1, p3*0.25, 2, p3*0.25, 3, p3*0.25, 0\n    \n    aOut = (kSelect < 0.5 ? aOrig : \\\n           (kSelect < 1.5 ? aInv : \\\n           (kSelect < 2.5 ? a90 : aReal)))\n    \n    outs aIn*0.5, aOut*0.5\nendin\n\ninstr 4\n    ; Frequency shifting with variable shift\n    ; Single-sideband modulation\n    \n    aIn vco2 0.3, 165, 10\n    \n    ; Hilbert transform\n    aReal, aImag hilbert aIn\n    \n    ; Sweep frequency shift\n    kShift linseg 0, p3*0.33, 300, p3*0.33, -200, p3*0.34, 0\n    \n    ; Modulation oscillators\n    aCos oscili 1, abs(kShift), -1\n    aSin oscili 1, abs(kShift), -1, 0.25  ; 90-degree phase\n    \n    ; Apply shift\n    aShifted = (kShift >= 0 ? aReal*aCos + aImag*aSin : aReal*aCos - aImag*aSin)\n    \n    outs aIn*0.4, aShifted*0.6\nendin\n\ninstr 5\n    ; Ring modulation using phase manipulation\n    ; Create sidebands with Hilbert transform\n    \n    ; Carrier\n    aCarr oscili 0.3, 440, -1\n    \n    ; Modulator\n    kModFreq linseg 50, p3, 200\n    aMod oscili 1, kModFreq, -1\n    \n    ; Hilbert transform of carrier\n    aReal, aImag hilbert aCarr\n    \n    ; Quadrature modulation for specific sidebands\n    aUpper = aReal * aMod\n    aLower = aImag * aMod\n    \n    ; Upper sideband only\n    outs aCarr*0.3, aUpper*0.7\nendin\n\ninstr 6\n    ; Stereo widening using phase\n    ; Phase-shifted stereo image\n    \n    aIn vco2 0.3, 220, 0\n    \n    ; Create quadrature pair\n    aReal, aImag hilbert aIn\n    \n    ; Use real and imaginary for L and R\n    ; Creates phase-coherent stereo\n    aLeft = aReal\n    aRight = aImag\n    \n    ; Adjust balance\n    aLeft *= 0.9\n    aRight *= 0.9\n    \n    outs aLeft, aRight\nendin\n\n</CsInstruments>\n<CsScore>\n\ni1 0 4\ni2 5 4\ni3 10 4\ni4 15 4\ni5 20 4\ni6 25 3\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
