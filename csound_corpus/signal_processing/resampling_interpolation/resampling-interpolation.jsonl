{"instruction": "Write a CSound instrument that demonstrates resampling and interpolation opcodes: upsamp, downsamp, interp", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ninstr 1\n    ; upsamp opcode: ares upsamp ksig\n    ; Convert k-rate signal to a-rate\n    ; ksig - k-rate input signal\n    \n    ; K-rate control signal\n    kFreq linseg 220, p3*0.5, 880, p3*0.5, 440\n    \n    ; Convert to a-rate\n    aFreq upsamp kFreq\n    \n    ; Use for audio-rate frequency modulation\n    aOsc oscili 0.3, aFreq, -1\n    \n    outs aOsc, aOsc\nendin\n\ninstr 2\n    ; downsamp opcode: kr downsamp asig\n    ; Convert a-rate signal to k-rate\n    ; asig - a-rate input signal\n    \n    ; A-rate signal\n    aLFO oscili 200, 3, -1\n    \n    ; Downsample to k-rate\n    kFreq downsamp aLFO\n    kFreq = 440 + kFreq\n    \n    ; Use k-rate value\n    aOsc oscili 0.3, kFreq, -1\n    \n    outs aOsc, aOsc\nendin\n\ninstr 3\n    ; interp opcode: ares interp ksig [, iskip]\n    ; Interpolate k-rate to a-rate (smoother than upsamp)\n    ; ksig - k-rate signal\n    ; iskip - skip initialization\n    \n    ; K-rate envelope\n    kEnv linseg 0, p3*0.25, 1, p3*0.5, 0.5, p3*0.25, 0\n    \n    ; Interpolate to a-rate\n    aEnv interp kEnv\n    \n    ; Apply to oscillator\n    aOsc vco2 0.3, 330, 10\n    aOut = aOsc * aEnv\n    \n    outs aOut, aOut\nendin\n\ninstr 4\n    ; Comparing upsamp vs interp\n    ; upsamp creates steps, interp is smooth\n    \n    kStep linseg 0.2, 1, 0.2, 0.01, 0.8, 1, 0.8, 0.01, 0.5, p3-2.02, 0.5\n    \n    ; Upsamp - stepped\n    aStep upsamp kStep\n    aOsc1 oscili aStep, 440, -1\n    \n    ; Interp - smooth\n    aSmooth interp kStep\n    aOsc2 oscili aSmooth, 440, -1\n    \n    outs aOsc1*0.5, aOsc2*0.5\nendin\n\ninstr 5\n    ; Downsample for control rate analysis\n    ; A-rate signal downsampled for k-rate processing\n    \n    aIn vco2 0.4, 165, 0\n    aIn *= linseg(1, p3*0.5, 0.3, p3*0.5, 1)\n    \n    ; Downsample to k-rate for analysis\n    kLevel downsamp aIn\n    kLevel = abs(kLevel)\n    \n    ; Use for threshold gate\n    kGate = (kLevel > 0.2 ? 1 : 0)\n    aGate interp kGate\n    \n    aOut = aIn * aGate\n    \n    outs aIn*0.5, aOut*0.5\nendin\n\ninstr 6\n    ; Rate conversion for modulation\n    ; K-rate LFO converted to a-rate for audio modulation\n    \n    ; K-rate LFO\n    kLFO lfo 0.5, 2, 0\n    \n    ; Convert to a-rate with interpolation\n    aLFO interp kLFO\n    \n    ; Use for amplitude modulation\n    aCarrier oscili 0.3, 440, -1\n    aOut = aCarrier * (1 + aLFO)\n    \n    outs aOut, aOut\nendin\n\n</CsInstruments>\n<CsScore>\n\ni1 0 3\ni2 4 3\ni3 8 4\ni4 13 4\ni5 18 3\ni6 22 4\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates table interpolation opcodes: vaget, tablei, table3, tablexkt", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function tables\ngiSine ftgen 0, 0, 8192, 10, 1\ngiSaw ftgen 0, 0, 8192, 7, -1, 4096, 1, 4096, -1\ngiWave ftgen 0, 0, 8192, 10, 1, 0.5, 0.3, 0.2, 0.1\ngiEnv ftgen 0, 0, 1024, 7, 0, 100, 1, 200, 0.8, 724, 0\n\ninstr 1\n    ; tablei opcode: ares tablei andx, ifn [, ixmode] [, ixoff] [, iwrap]\n    ; Table lookup with linear interpolation\n    ; andx - index (normalized or raw)\n    ; ifn - function table number\n    ; ixmode - index mode (0=raw, 1=normalized)\n    ; ixoff - index offset\n    ; iwrap - wraparound mode\n    \n    ; Phase for table lookup\n    aPhase phasor 220\n    \n    ; Read table with linear interpolation\n    aOut tablei aPhase, giSine, 1\n    aOut *= 0.3\n    \n    outs aOut, aOut\nendin\n\ninstr 2\n    ; table3 opcode: ares table3 andx, ifn [, ixmode] [, ixoff] [, iwrap]\n    ; Table lookup with cubic interpolation (higher quality)\n    ; andx - index\n    ; ifn - function table\n    \n    ; Variable frequency\n    kFreq linseg 110, p3*0.5, 440, p3*0.5, 220\n    aPhase phasor kFreq\n    \n    ; Read with cubic interpolation\n    aOut table3 aPhase, giWave, 1\n    aOut *= 0.3\n    \n    outs aOut, aOut\nendin\n\ninstr 3\n    ; tablexkt opcode: ares tablexkt andx, kfn, kwarp, iwsize [, ixmode] [, ixoff] [, iwrap]\n    ; Table lookup with crossfade between tables\n    ; kfn - table number (can morph between tables)\n    ; kwarp - warp factor\n    ; iwsize - window size\n    \n    ; Phase\n    aPhase phasor 330\n    \n    ; Morph between tables\n    kTable linseg 1, p3*0.5, 2, p3*0.5, 1\n    \n    ; Crossfade between sine and saw\n    kBlend = kTable - 1  ; 0 to 1\n    \n    aSine tablei aPhase, giSine, 1\n    aSaw tablei aPhase, giSaw, 1\n    aOut = aSine*(1-kBlend) + aSaw*kBlend\n    aOut *= 0.3\n    \n    outs aOut, aOut\nendin\n\ninstr 4\n    ; vaget opcode: ares vaget andx, ifn, ixmode [, interp]\n    ; Variable-rate table read\n    ; andx - index\n    ; ifn - function table\n    ; ixmode - index mode\n    ; interp - interpolation type\n    \n    ; Time-varying index\n    aIndex linseg 0, p3, 1\n    \n    ; Read envelope table\n    aEnv tablei aIndex, giEnv, 1\n    \n    ; Apply to oscillator\n    aOsc oscili 0.3, 440, -1\n    aOut = aOsc * aEnv\n    \n    outs aOut, aOut\nendin\n\ninstr 5\n    ; Comparing interpolation methods\n    ; Linear vs cubic\n    \n    kFreq = 165\n    aPhase phasor kFreq\n    \n    ; Linear interpolation\n    aLinear tablei aPhase, giWave, 1\n    \n    ; Cubic interpolation (smoother)\n    aCubic table3 aPhase, giWave, 1\n    \n    ; Scale\n    aLinear *= 0.3\n    aCubic *= 0.3\n    \n    outs aLinear, aCubic\nendin\n\ninstr 6\n    ; Dynamic table scanning\n    ; Variable speed scanning through table\n    \n    ; Scan speed varies\n    kSpeed linseg 0.5, p3*0.5, 3, p3*0.5, 1\n    aPhase phasor kSpeed\n    \n    ; Read with cubic interpolation\n    aOut table3 aPhase, giWave, 1\n    aOut *= 0.3\n    \n    ; Apply envelope\n    aEnv linseg 1, p3*0.9, 1, p3*0.1, 0\n    aOut *= aEnv\n    \n    outs aOut, aOut\nendin\n\n</CsInstruments>\n<CsScore>\n\ni1 0 2\ni2 3 4\ni3 8 4\ni4 13 3\ni5 17 3\ni6 21 5\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates oscillator interpolation opcodes: oscili, osciliktp", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Waveform tables\ngiSine ftgen 0, 0, 8192, 10, 1\ngiTri ftgen 0, 0, 8192, 10, 1, 0, -0.111, 0, 0.04, 0, -0.020408\ngiSaw ftgen 0, 0, 8192, 10, 1, -0.5, 0.333, -0.25, 0.2, -0.167\ngiSquare ftgen 0, 0, 8192, 10, 1, 0, 0.333, 0, 0.2, 0, 0.143\n\ninstr 1\n    ; oscili opcode: ares oscili xamp, xcps, ifn [, iphs]\n    ; Oscillator with linear interpolation\n    ; xamp - amplitude\n    ; xcps - frequency (Hz)\n    ; ifn - function table\n    ; iphs - initial phase (0-1)\n    \n    ; Basic sine oscillator\n    aOsc oscili 0.3, 440, giSine\n    \n    outs aOsc, aOsc\nendin\n\ninstr 2\n    ; oscili with variable frequency\n    ; Demonstrates smooth interpolation during frequency changes\n    \n    kFreq linseg 220, p3*0.5, 880, p3*0.5, 330\n    aOsc oscili 0.3, kFreq, giSine\n    \n    outs aOsc, aOsc\nendin\n\ninstr 3\n    ; oscili with different waveforms\n    ; Triangle wave\n    \n    kFreq = 330\n    aTri oscili 0.3, kFreq, giTri\n    \n    outs aTri, aTri\nendin\n\ninstr 4\n    ; osciliktp opcode: ares osciliktp kcps, kfn, kphs [, iphs]\n    ; Oscillator with k-rate table and phase control\n    ; kcps - frequency (k-rate)\n    ; kfn - function table (k-rate, can change)\n    ; kphs - phase (k-rate)\n    ; iphs - initial phase\n    \n    kFreq = 220\n    \n    ; Morph between waveforms\n    kTable linseg 1, p3*0.33, 2, p3*0.33, 3, p3*0.34, 1\n    \n    ; Select table based on kTable\n    kFn = (kTable < 1.5 ? giSine : (kTable < 2.5 ? giTri : giSaw))\n    \n    ; Phase control\n    kPhase = 0\n    \n    aOsc osciliktp kFreq, kFn, kPhase\n    aOsc *= 0.3\n    \n    outs aOsc, aOsc\nendin\n\ninstr 5\n    ; Phase offset with oscili\n    ; Multiple oscillators with phase offsets for stereo\n    \n    kFreq = 165\n    \n    ; Left channel - phase 0\n    aL oscili 0.25, kFreq, giSine, 0\n    \n    ; Right channel - phase 0.25 (90 degrees)\n    aR oscili 0.25, kFreq, giSine, 0.25\n    \n    outs aL, aR\nendin\n\ninstr 6\n    ; Dynamic phase control with osciliktp\n    ; Phase modulation\n    \n    kFreq = 220\n    kFn = giSine\n    \n    ; Varying phase offset\n    kPhase linseg 0, p3*0.5, 0.5, p3*0.5, 0\n    \n    aOsc osciliktp kFreq, kFn, kPhase\n    aOsc *= 0.3\n    \n    outs aOsc, aOsc\nendin\n\ninstr 7\n    ; Waveform morphing with osciliktp\n    ; Smooth transitions between multiple waveforms\n    \n    kFreq linseg 110, p3, 440\n    \n    ; Cycle through waveforms\n    kWavePos linseg 0, p3, 4\n    \n    ; Crossfade between adjacent waveforms\n    kBlend = frac(kWavePos)\n    iWave1 = int(kWavePos) % 4\n    iWave2 = (int(kWavePos) + 1) % 4\n    \n    ; Generate from both tables\n    aOsc1 oscili 0.3, kFreq, giSine + iWave1\n    aOsc2 oscili 0.3, kFreq, giSine + iWave2\n    \n    ; Crossfade\n    aOut = aOsc1*(1-kBlend) + aOsc2*kBlend\n    \n    outs aOut, aOut\nendin\n\ninstr 8\n    ; High-quality additive synthesis using oscili\n    ; Multiple oscillators with precise interpolation\n    \n    kFund = 110\n    \n    ; 8 harmonics with interpolation\n    aSum = 0\n    iHarm = 1\n    while iHarm <= 8 do\n        kFreq = kFund * iHarm\n        kAmp = 0.3 / iHarm\n        aPartial oscili kAmp, kFreq, giSine\n        aSum = aSum + aPartial\n        iHarm += 1\n    od\n    \n    aSum *= 0.4\n    \n    outs aSum, aSum\nendin\n\n</CsInstruments>\n<CsScore>\n\ni1 0 2\ni2 3 4\ni3 8 2\ni4 11 5\ni5 17 3\ni6 21 4\ni7 26 5\ni8 32 4\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
