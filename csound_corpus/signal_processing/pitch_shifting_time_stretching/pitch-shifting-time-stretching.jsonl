{"instruction": "Write a CSound instrument that demonstrates pitch shifting and time stretching opcodes: pvshift, pvscale, pvstanal, sndwarp, sndwarpst, mincer, temposcal, pshift", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ninstr 1\n    ; pvsanal/pvshift/pvsynth - phase vocoder pitch shifting\n    ; pvshift opcode: fsig pvshift fsig, kshift, klowest [, kkeepform, kgain, kcoefs]\n    ; Pitch shift using phase vocoder\n    ; fsig - input fsig\n    ; kshift - shift in Hz\n    ; klowest - lowest frequency to shift\n    ; kkeepform - preserve formants (0-1)\n    \n    kAmp madsr 0.01, 0.1, 0.7, 0.2\n    \n    ; Sawtooth source\n    aSaw vco2 kAmp*0.3, 220, 0\n    \n    ; Analyze\n    fftsig pvsanal aSaw, 1024, 256, 1024, 1\n    \n    ; Shift up by 300 Hz\n    fshift pvshift fftsig, 300, 0, 0\n    \n    ; Resynthesize\n    aShift pvsynth fshift\n    \n    outs aShift, aShift\nendin\n\ninstr 2\n    ; pvscale - time scaling\n    ; fsig pvscale fsig, kscale [, kkeepform, kgain, kcoefs]\n    ; kscale - scaling factor (2=up octave, 0.5=down octave)\n    \n    kAmp madsr 0.015, 0.08, 0.65, 0.25\n    \n    ; Pulse wave\n    aPulse vco2 kAmp*0.3, 165, 2, 0.4\n    \n    ; Analyze\n    fftsig pvsanal aPulse, 1024, 256, 1024, 1\n    \n    ; Scale up octave\n    fscale pvscale fftsig, 2\n    \n    ; Resynthesize\n    aScale pvsynth fscale\n    \n    outs aScale, aScale\nendin\n\ninstr 3\n    ; mincer opcode: asig mincer atimept, kamp, kpitch, ifile [, ilock, ifftsize, idecim]\n    ; Time stretching with pitch shifting\n    ; atimept - time pointer into file (seconds)\n    ; kamp - amplitude\n    ; kpitch - pitch scaling (1=normal, 2=up octave)\n    ; ifile - file table or file name\n    ; Note: Requires audio file\n    \n    kAmp madsr 0.02, 0.12, 0.6, 0.3\n    \n    ; Generate source\n    aSrc vco2 kAmp*0.3, 110, 0\n    \n    ; Simulated with pvscale\n    fftsig pvsanal aSrc, 2048, 512, 2048, 1\n    \n    ; Pitch shift\n    kPitch = 1.5\n    fshift pvscale fftsig, kPitch\n    \n    aOut pvsynth fshift\n    \n    outs aOut, aOut\nendin\n\ninstr 4\n    ; temposcal - independent time/pitch control\n    ; ares temposcal ktimescal, kpitch, asig [, ifftsize, ioverlap, iwintype]\n    ; ktimescal - time scaling (1=normal, 2=half speed)\n    ; kpitch - pitch scaling (1=normal, 2=up octave)\n    ; Note: Not all Csound builds have this\n    \n    kAmp madsr 0.01, 0.1, 0.7, 0.2\n    \n    ; Square wave\n    aSq vco2 kAmp*0.3, 220, 2\n    \n    ; Use pvscale as alternative\n    fftsig pvsanal aSq, 1024, 256, 1024, 1\n    fscale pvscale fftsig, 0.5  ; Down octave\n    \n    aOut pvsynth fscale\n    \n    outs aOut, aOut\nendin\n\ninstr 5\n    ; pshift - simple pitch shifter\n    ; aout1, aout2 pshift ain, kratio, kloopsize, kifftsize, ioverlap\n    ; kratio - pitch ratio (2=up octave)\n    ; Note: May not be available in all builds\n    \n    kAmp madsr 0.015, 0.08, 0.65, 0.25\n    \n    ; Sawtooth\n    aSaw vco2 kAmp*0.25, 165, 0\n    \n    ; Use pvscale\n    fftsig pvsanal aSaw, 2048, 512, 2048, 1\n    kRatio = 1.25893  ; Perfect fifth up\n    fshift pvscale fftsig, kRatio\n    \n    aOut pvsynth fshift\n    \n    outs aOut, aOut\nendin\n\ninstr 6\n    ; Dynamic pitch shifting\n    kAmp madsr 0.02, 0.12, 0.6, 0.3\n    \n    ; Pulse wave\n    aPulse vco2 kAmp*0.3, 220, 2, 0.3\n    \n    ; Analyze\n    fftsig pvsanal aPulse, 1024, 256, 1024, 1\n    \n    ; Sweep pitch\n    kScale linseg 0.5, p3*0.5, 2, p3*0.5, 1\n    fshift pvscale fftsig, kScale\n    \n    aOut pvsynth fshift\n    \n    outs aOut, aOut\nendin\n\n</CsInstruments>\n<CsScore>\n\ni1 0 3\ni2 3.5 3\ni3 7 3\ni4 10.5 3\ni5 14 3\ni6 17.5 4\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
