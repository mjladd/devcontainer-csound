{"instruction": "Write a CSound instrument that demonstrates auto-wah filter effect opcodes: wguide1, wguide2, resonant filters with envelope following", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ninstr 1\n    ; Basic auto-wah using envelope follower + resonant filter\n    ; Input signal\n    aIn vco2 0.4, 110, 2, 0.5\n    aIn *= linseg(0.1, 0.05, 1, 0.1, 0.3, p3-0.15, 0.1)\n    \n    ; Follow envelope\n    aEnv follow2 aIn, 0.005, 0.1\n    \n    ; Map envelope to filter frequency\n    kCf = 300 + aEnv*2500\n    \n    ; Resonant bandpass filter\n    aWah butterbp aIn, kCf, kCf*0.3\n    \n    ; Mix dry and wet\n    aOut = aIn*0.3 + aWah*0.7\n    \n    outs aOut, aOut\nendin\n\ninstr 2\n    ; Auto-wah with variable resonance\n    aIn buzz 0.4, 165, 20, -1\n    aIn *= expseg(1, 0.01, 0.3, 0.2, 0.5, p3-0.21, 0.1)\n    \n    ; Envelope follower\n    aEnv follow2 aIn, 0.002, 0.08\n    \n    ; Control frequency and Q\n    kCf = 200 + aEnv*3000\n    kQ linseg 5, p3*0.5, 20, p3*0.5, 10\n    \n    ; Resonant filter\n    aWah rbjeq aIn, 2, kCf, kQ, 1  ; Mode 2 = bandpass\n    \n    aOut = aIn*0.2 + aWah*0.8\n    \n    outs aOut, aOut\nendin\n\ninstr 3\n    ; Multi-mode auto-wah\n    ; Switches between lowpass and bandpass\n    \n    aIn vco2 0.4, 220, 0\n    aIn *= linseg(0.2, 0.1, 1, 0.2, 0.4, p3-0.3, 0.2)\n    \n    ; Envelope\n    aEnv follow2 aIn, 0.01, 0.15\n    \n    ; Frequency control\n    kCf = 400 + aEnv*2000\n    \n    ; Mode switching\n    kMode linseg 0, p3*0.5, 1, p3*0.5, 0\n    \n    ; Lowpass wah\n    aLP butterlp aIn, kCf\n    \n    ; Bandpass wah\n    aBP butterbp aIn, kCf, kCf*0.4\n    \n    ; Crossfade between modes\n    aWah = aLP*(1-kMode) + aBP*kMode\n    \n    aOut = aIn*0.3 + aWah*0.7\n    \n    outs aOut, aOut\nendin\n\ninstr 4\n    ; Wah with LFO modulation\n    aIn vco2 0.4, 165, 10\n    \n    ; Envelope follower\n    aEnv follow2 aIn, 0.005, 0.1\n    \n    ; LFO for sweep\n    kLFO lfo 1, 1.5, 0\n    kLFO = (kLFO + 1) * 0.5  ; 0 to 1\n    \n    ; Combine envelope and LFO\n    kCf = 300 + aEnv*1500 + kLFO*1000\n    \n    ; Apply filter\n    aWah butterbp aIn, kCf, kCf*0.5\n    \n    aOut = aIn*0.3 + aWah*0.7\n    \n    outs aOut, aOut\nendin\n\ninstr 5\n    ; Wah with variable sensitivity\n    aIn buzz 0.4, 110, 25, -1\n    aIn *= linseg(0.1, 0.08, 1, 0.15, 0.5, p3-0.23, 0.2)\n    \n    ; Envelope\n    aEnv follow2 aIn, 0.003, 0.12\n    \n    ; Sensitivity control\n    kSens linseg 1, p3*0.5, 5, p3*0.5, 2\n    \n    ; Apply sensitivity\n    kEnvScaled = aEnv * kSens\n    kEnvScaled limit kEnvScaled, 0, 1\n    \n    ; Filter\n    kCf = 250 + kEnvScaled*3000\n    aWah butterbp aIn, kCf, kCf*0.4\n    \n    aOut = aIn*0.25 + aWah*0.75\n    \n    outs aOut, aOut\nendin\n\ninstr 6\n    ; Stereo auto-wah with different frequencies per channel\n    aIn vco2 0.4, 220, 0\n    aIn *= linseg(0.2, 0.05, 1, 0.1, 0.4, p3-0.15, 0.2)\n    \n    ; Envelope\n    aEnv follow2 aIn, 0.005, 0.1\n    \n    ; Different frequency ranges for L and R\n    kCfL = 400 + aEnv*2000\n    kCfR = 600 + aEnv*1800\n    \n    ; Stereo filters\n    aWahL butterbp aIn, kCfL, kCfL*0.4\n    aWahR butterbp aIn, kCfR, kCfR*0.4\n    \n    aOutL = aIn*0.3 + aWahL*0.7\n    aOutR = aIn*0.3 + aWahR*0.7\n    \n    outs aOutL, aOutR\nendin\n\n</CsInstruments>\n<CsScore>\n\ni1 0 3\ni2 4 3\ni3 8 4\ni4 13 4\ni5 18 3\ni6 22 4\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
