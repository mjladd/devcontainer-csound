{"instruction": "Write a CSound instrument that demonstrates the pluck opcode for Karplus-Strong synthesis", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ninstr 1\n    ; pluck opcode: ares pluck kamp, kcps, icps, ifn, imeth [, iparm1] [, iparm2]\n    ; pluck implements the Karplus-Strong algorithm\n    ; kamp - amplitude\n    ; kcps - frequency in Hz\n    ; icps - intended frequency (for calculation)\n    ; ifn - function table for initial waveform\n    ; imeth - pluck method (1=simple, 2=stretched, 3=simple drum, 4=stretched drum, 5=weighted, 6=recursive filter)\n    ; iparm1, iparm2 - method-specific parameters\n    \n    iAmp = 0.5\n    iFreq = p4\n    iFn = 0  ; 0 means random initial waveform\n    iMeth = 1  ; Simple averaging\n    \n    ; Basic plucked string\n    aPluck pluck iAmp, iFreq, iFreq, iFn, iMeth\n    \n    outs aPluck, aPluck\nendin\n\ninstr 2\n    ; Stretched string (method 2)\n    iAmp = 0.5\n    iFreq = p4\n    iFn = 0\n    iMeth = 2\n    iStretch = p5  ; Stretch parameter (0-1)\n    \n    aPluck pluck iAmp, iFreq, iFreq, iFn, iMeth, iStretch\n    \n    outs aPluck, aPluck\nendin\n\ninstr 3\n    ; Drum-like sound (method 3)\n    iAmp = 0.6\n    iFreq = p4\n    iFn = 0\n    iMeth = 3\n    \n    aPluck pluck iAmp, iFreq, iFreq, iFn, iMeth\n    \n    outs aPluck, aPluck\nendin\n\ninstr 4\n    ; Weighted averaging (method 5)\n    iAmp = 0.5\n    iFreq = p4\n    iFn = 0\n    iMeth = 5\n    iWeight = p5  ; Weighting (0-1)\n    \n    aPluck pluck iAmp, iFreq, iFreq, iFn, iMeth, iWeight\n    \n    outs aPluck, aPluck\nendin\n\ninstr 5\n    ; Recursive filter (method 6)\n    iAmp = 0.5\n    iFreq = p4\n    iFn = 0\n    iMeth = 6\n    iDecay = 0.9  ; Decay factor\n    \n    aPluck pluck iAmp, iFreq, iFreq, iFn, iMeth, iDecay\n    \n    outs aPluck, aPluck\nendin\n\ninstr 6\n    ; Pitch bend\n    iAmp = 0.5\n    iStart = p4\n    iEnd = p5\n    iFn = 0\n    iMeth = 1\n    \n    ; Frequency changes\n    kFreq expseg iStart, p3, iEnd\n    \n    aPluck pluck iAmp, kFreq, iStart, iFn, iMeth\n    \n    outs aPluck, aPluck\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play simple pluck\ni1 0 3 440\ni1 3.5 3 330\n\n; Play stretched (different stretch values)\n; Format: start dur freq stretch\ni2 7.5 3 392 0.3\ni2 10.5 3 392 0.7\n\n; Play drum-like\ni3 14 1 220\ni3 15 1 165\ni3 16 1 130\n\n; Play weighted\n; Format: start dur freq weight\ni4 17.5 3 294 0.3\ni4 20.5 3 294 0.8\n\n; Play recursive filter\ni5 24 3 523\n\n; Play pitch bend\n; Format: start dur freq_start freq_end\ni6 28 2 220 440\ni6 30 2 440 220\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates the streson opcode for string resonance", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ngiSine ftgen 1, 0, 16384, 10, 1\n\ninstr 1\n    ; streson opcode: asig streson ain, kfr, kfdbgain\n    ; streson is a string resonator that simulates string vibration\n    ; ain - input signal (excitation)\n    ; kfr - fundamental frequency\n    ; kfdbgain - feedback gain (affects decay time)\n    \n    iAmp = 0.5\n    iFreq = p4\n    \n    ; Impulse excitation\n    aExcite mpulse 0.8, 0\n    \n    ; String resonator\n    kFeedback = 0.95\n    aString streson aExcite, iFreq, kFeedback\n    \n    outs aString*iAmp, aString*iAmp\nendin\n\ninstr 2\n    ; Continuous excitation (bowed)\n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Noise excitation\n    aNoise noise 0.05, 0\n    \n    ; String resonator with high feedback\n    kFeedback = 0.99\n    aString streson aNoise, iFreq, kFeedback\n    \n    outs aString*iAmp, aString*iAmp\nendin\n\ninstr 3\n    ; Variable decay time\n    iAmp = 0.5\n    iFreq = p4\n    \n    ; Impulse\n    aExcite mpulse 0.8, 0\n    \n    ; Feedback changes (affects decay)\n    kFeedback linseg 0.98, p3, 0.85\n    \n    aString streson aExcite, iFreq, kFeedback\n    \n    outs aString*iAmp, aString*iAmp\nendin\n\ninstr 4\n    ; Frequency sweep\n    iAmp = 0.5\n    \n    ; Impulse\n    aExcite mpulse 0.8, 0\n    \n    ; Frequency changes\n    iStart = p4\n    iEnd = p5\n    kFreq expseg iStart, p3, iEnd\n    \n    kFeedback = 0.96\n    aString streson aExcite, kFreq, kFeedback\n    \n    outs aString*iAmp, aString*iAmp\nendin\n\ninstr 5\n    ; Combined with pluck\n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Pluck as excitation\n    aPluck pluck 0.8, iFreq, iFreq, 0, 1\n    \n    ; Add string resonance\n    kFeedback = 0.93\n    aString streson aPluck, iFreq, kFeedback\n    \n    outs aString*iAmp, aString*iAmp\nendin\n\ninstr 6\n    ; Multiple strings (sympathetic resonance)\n    iAmp = 0.3\n    iFreq = p4\n    \n    ; Excitation\n    aExcite mpulse 0.8, 0\n    \n    ; Main string\n    aString1 streson aExcite, iFreq, 0.95\n    \n    ; Sympathetic strings (harmonics)\n    aString2 streson aExcite*0.5, iFreq*2, 0.93\n    aString3 streson aExcite*0.3, iFreq*3, 0.91\n    \n    aMix = (aString1 + aString2 + aString3) * iAmp\n    \n    outs aMix, aMix\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play basic streson\ni1 0 3 440\ni1 3.5 3 523\n\n; Play bowed\ni2 7.5 4 330\n\n; Play variable decay\ni3 12.5 4 392\n\n; Play frequency sweep\n; Format: start dur freq_start freq_end\ni4 17.5 3 220 660\ni4 20.5 3 660 220\n\n; Play with pluck\ni5 24.5 3 294\n\n; Play sympathetic resonance\ni6 28.5 4 220\ni6 32.5 4 330\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates advanced Karplus-Strong techniques", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ninstr 1\n    ; Guitar-like with pluck + streson\n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Initial pluck\n    aPluck pluck 0.8, iFreq, iFreq, 0, 1\n    \n    ; String resonance\n    aString streson aPluck, iFreq, 0.95\n    \n    ; Body resonance (simple filter)\n    aBody butterbp aString, 200, 100\n    \n    aMix = (aString*0.7 + aBody*0.3) * iAmp\n    \n    outs aMix, aMix\nendin\n\ninstr 2\n    ; Detuned strings (chorus)\n    iAmp = 0.3\n    iFreq = p4\n    \n    ; Three slightly detuned strings\n    aPluck1 pluck 0.7, iFreq*0.998, iFreq*0.998, 0, 1\n    aPluck2 pluck 0.7, iFreq, iFreq, 0, 1\n    aPluck3 pluck 0.7, iFreq*1.002, iFreq*1.002, 0, 1\n    \n    aMix = (aPluck1 + aPluck2 + aPluck3) * iAmp\n    \n    outs aMix, aMix\nendin\n\ninstr 3\n    ; Strumming pattern\n    iAmp = 0.35\n    iRoot = p4\n    \n    ; Chord notes\n    i5th = iRoot * 3/2\n    i8ve = iRoot * 2\n    \n    ; Staggered plucks\n    aPluck1 mpulse 0.7, 0\n    aPluck2 mpulse 0.7, p3*0.05\n    aPluck3 mpulse 0.7, p3*0.1\n    \n    ; Three strings\n    aStr1 pluck iAmp, iRoot, iRoot, 0, 1\n    aStr2 pluck iAmp, i5th, i5th, 0, 1\n    aStr3 pluck iAmp, i8ve, i8ve, 0, 1\n    \n    aMix = aStr1 + aStr2 + aStr3\n    \n    outs aMix, aMix\nendin\n\ninstr 4\n    ; Damped pluck (palm mute)\n    iAmp = 0.5\n    iFreq = p4\n    \n    ; Pluck with recursive filter for quick damping\n    aPluck pluck iAmp, iFreq, iFreq, 0, 6, 0.7\n    \n    ; Additional damping envelope\n    aDamp expseg 1, 0.5, 0.01\n    \n    outs aPluck*aDamp, aPluck*aDamp\nendin\n\ninstr 5\n    ; Harmonic pluck\n    iAmp = 0.4\n    iFreq = p4\n    iHarmonic = p5\n    \n    ; Pluck at harmonic\n    aPluck pluck iAmp, iFreq*iHarmonic, iFreq*iHarmonic, 0, 1\n    \n    ; Resonate at fundamental\n    aString streson aPluck*0.5, iFreq, 0.94\n    \n    aMix = aPluck*0.5 + aString*0.5\n    \n    outs aMix, aMix\nendin\n\ninstr 6\n    ; Bowed string with streson\n    iAmp = 0.35\n    iFreq = p4\n    \n    ; Envelope for bow pressure\n    kEnv linseg 0, 0.2, 1, p3-0.4, 1, 0.2, 0\n    \n    ; Filtered noise for bow\n    aNoise noise kEnv*0.03, 0\n    aFilt butterlp aNoise, 3000\n    \n    ; String resonator\n    aString streson aFilt, iFreq, 0.99\n    \n    outs aString*iAmp, aString*iAmp\nendin\n\ninstr 7\n    ; Prepared string (muted harmonics)\n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Pluck\n    aPluck pluck 0.8, iFreq, iFreq, 0, 2, 0.5\n    \n    ; Multiple resonators at inharmonic ratios\n    aRes1 streson aPluck, iFreq, 0.92\n    aRes2 streson aPluck, iFreq*2.3, 0.89\n    aRes3 streson aPluck, iFreq*3.7, 0.86\n    \n    aMix = (aRes1*0.5 + aRes2*0.3 + aRes3*0.2) * iAmp\n    \n    outs aMix, aMix\nendin\n\ninstr 8\n    ; Slide guitar\n    iAmp = 0.5\n    iStart = p4\n    iEnd = p5\n    \n    ; Initial pluck\n    aPluck mpulse 0.8, 0\n    \n    ; Sliding frequency\n    kFreq expseg iStart, p3, iEnd\n    \n    ; Resonator follows pitch\n    aString streson aPluck, kFreq, 0.97\n    \n    outs aString*iAmp, aString*iAmp\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play guitar-like\ni1 0 3 220\ni1 3.5 3 294\n\n; Play chorus\ni2 7.5 3 330\n\n; Play strum\ni3 11.5 2 220\ni3 13.5 2 330\n\n; Play palm mute\ni4 16.5 1 392\ni4 17.5 1 440\ni4 18.5 1 523\n\n; Play harmonics\n; Format: start dur fundamental harmonic\ni5 20.5 2 220 2\ni5 22.5 2 220 3\ni5 24.5 2 220 4\n\n; Play bowed\ni6 27.5 4 165\n\n; Play prepared\ni7 32.5 3 294\n\n; Play slide\n; Format: start dur freq_start freq_end\ni8 36.5 3 220 440\ni8 39.5 3 440 220\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
