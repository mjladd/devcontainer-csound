{"instruction": "Write a CSound instrument that demonstrates basic FFT analysis and resynthesis", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ngiSine ftgen 1, 0, 16384, 10, 1\ngiHann ftgen 2, 0, 4096, 20, 2, 1\n\ninstr 1\n    ; pvsanal opcode: fsig pvsanal ain, ifftsize, ioverlap, iwinsize, iwintype [, iformat] [, iinit]\n    ; pvsanal analyzes audio into spectral (phase vocoder) format\n    ; ain - input audio signal\n    ; ifftsize - FFT size (power of 2)\n    ; ioverlap - overlap factor\n    ; iwinsize - window size\n    ; iwintype - window type\n    \n    ; pvsynth opcode: aout pvsynth fsig [, iinit]\n    ; pvsynth resynthesizes audio from spectral format\n    ; fsig - spectral signal from pvsanal\n    \n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Generate source\n    aSource poscil iAmp, iFreq, giSine\n    \n    ; Analyze\n    fSig pvsanal aSource, 2048, 256, 2048, 1\n    \n    ; Resynthesize\n    aOut pvsynth fSig\n    \n    outs aOut, aOut\nendin\n\ninstr 2\n    ; pvsadsyn opcode: ares pvsadsyn fsig, inoscs, kfmod [, ibinfrom] [, ibinto] [, iinit]\n    ; pvsadsyn resynthesizes using additive synthesis with oscillator bank\n    ; fsig - spectral signal\n    ; inoscs - number of oscillators\n    ; kfmod - frequency modifier\n    \n    iAmp = 0.4\n    iFreq = p4\n    \n    aSource poscil iAmp, iFreq, giSine\n    \n    ; Analyze\n    fSig pvsanal aSource, 2048, 256, 2048, 1\n    \n    ; Resynthesize with oscillators\n    kFmod = 1\n    aOut pvsadsyn fSig, 100, kFmod\n    \n    outs aOut*0.5, aOut*0.5\nendin\n\ninstr 3\n    ; resyn opcode: asig resyn fin, iper, ksclmin, ksclmax [, kfund, imode, ithresh]\n    ; resyn performs frequency-domain analysis and resynthesis\n    ; fin - fsig input\n    ; iper - period size\n    ; ksclmin, ksclmax - frequency scale min/max\n    \n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Source with harmonics\n    aSource poscil iAmp, iFreq, giSine\n    aHarm2 poscil iAmp*0.5, iFreq*2, giSine\n    aHarm3 poscil iAmp*0.3, iFreq*3, giSine\n    aIn = aSource + aHarm2 + aHarm3\n    \n    ; Analyze\n    fSig pvsanal aIn, 2048, 256, 2048, 1\n    \n    ; Resynthesize with tracking\n    aOut resyn fSig, 100, 0.5, 2\n    \n    outs aOut*0.3, aOut*0.3\nendin\n\ninstr 4\n    ; adsyn opcode: ar1 [, ar2...] adsyn fin, inum, iinit\n    ; adsyn resynthesizes spectral data using additive synthesis\n    ; fin - fsig input\n    ; inum - number of partials\n    \n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Source\n    aSource poscil iAmp, iFreq, giSine\n    \n    ; Analyze\n    fSig pvsanal aSource, 1024, 128, 1024, 1\n    \n    ; Additive resynth\n    aOut adsyn fSig, 50, 1\n    \n    outs aOut*0.5, aOut*0.5\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play basic analysis/resynthesis\ni1 0 3 220\ni1 3.5 3 440\n\n; Play additive resynthesis\ni2 7.5 3 330\n\n; Play tracking resynthesis\ni3 11.5 3 294\n\n; Play adsyn\ni4 15.5 3 392\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates spectral filtering and processing", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ngiSaw ftgen 1, 0, 16384, 10, 1, 0.5, 0.3, 0.25, 0.2, 0.16, 0.14, 0.12\n\ninstr 1\n    ; pvsfilter opcode: fsig pvsfilter fsigin, fsigfilt, kdepth [, igain]\n    ; pvsfilter filters spectrum using another spectrum as filter\n    ; fsigin - input spectrum\n    ; fsigfilt - filter spectrum\n    ; kdepth - filter depth (0-1)\n    \n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Source signal (sawtooth)\n    aSource poscil iAmp, iFreq, giSaw\n    \n    ; Filter modulator (sine)\n    aFilt poscil 0.5, iFreq*0.5, 1\n    \n    ; Analyze both\n    fSource pvsanal aSource, 2048, 256, 2048, 1\n    fFilt pvsanal aFilt, 2048, 256, 2048, 1\n    \n    ; Apply spectral filter\n    kDepth = 0.8\n    fFiltered pvsfilter fSource, fFilt, kDepth\n    \n    ; Resynthesize\n    aOut pvsynth fFiltered\n    \n    outs aOut, aOut\nendin\n\ninstr 2\n    ; pvsmooth opcode: fsig pvsmooth fsigin, kacf, kfcf\n    ; pvsmooth smooths spectral data\n    ; fsigin - input spectrum\n    ; kacf - amplitude coefficient (0-1)\n    ; kfcf - frequency coefficient (0-1)\n    \n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Rich source\n    aSource poscil iAmp, iFreq, giSaw\n    \n    ; Analyze\n    fSig pvsanal aSource, 2048, 256, 2048, 1\n    \n    ; Smooth\n    kAmpSmooth = 0.5\n    kFreqSmooth = 0.7\n    fSmooth pvsmooth fSig, kAmpSmooth, kFreqSmooth\n    \n    ; Resynthesize\n    aOut pvsynth fSmooth\n    \n    outs aOut, aOut\nendin\n\ninstr 3\n    ; pvsblur opcode: fsig pvsblur fsigin, kblurtime, imaxdelay\n    ; pvsblur blurs spectrum over time\n    ; fsigin - input spectrum\n    ; kblurtime - blur time in seconds\n    ; imaxdelay - maximum delay time\n    \n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Source\n    aSource poscil iAmp, iFreq, giSaw\n    \n    ; Analyze\n    fSig pvsanal aSource, 2048, 256, 2048, 1\n    \n    ; Blur\n    kBlurTime = 0.2\n    fBlur pvsblur fSig, kBlurTime, 2\n    \n    ; Resynthesize\n    aOut pvsynth fBlur\n    \n    outs aOut, aOut\nendin\n\ninstr 4\n    ; pvsfreeze opcode: fsig pvsfreeze fsigin, kfreeza, kfreezf\n    ; pvsfreeze freezes spectral components\n    ; fsigin - input spectrum\n    ; kfreeza - freeze amplitudes (0=no freeze, 1=freeze)\n    ; kfreezf - freeze frequencies (0=no freeze, 1=freeze)\n    \n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Source\n    aSource poscil iAmp, iFreq, giSaw\n    \n    ; Analyze\n    fSig pvsanal aSource, 2048, 256, 2048, 1\n    \n    ; Freeze after 1 second\n    kFreezeAmp linseg 0, 1, 0, 0.1, 1, p3-1.1, 1\n    kFreezeFreq = kFreezeAmp\n    \n    fFreeze pvsfreeze fSig, kFreezeAmp, kFreezeFreq\n    \n    ; Resynthesize\n    aOut pvsynth fFreeze\n    \n    outs aOut, aOut\nendin\n\ninstr 5\n    ; pvsmix opcode: fsig pvsmix fsig1, fsig2\n    ; pvsmix mixes two spectral signals\n    ; fsig1, fsig2 - input spectra\n    \n    iAmp = 0.3\n    iFreq1 = p4\n    iFreq2 = p5\n    \n    ; Two sources\n    aSource1 poscil iAmp, iFreq1, giSaw\n    aSource2 poscil iAmp, iFreq2, 1\n    \n    ; Analyze\n    fSig1 pvsanal aSource1, 2048, 256, 2048, 1\n    fSig2 pvsanal aSource2, 2048, 256, 2048, 1\n    \n    ; Mix\n    fMix pvsmix fSig1, fSig2\n    \n    ; Resynthesize\n    aOut pvsynth fMix\n    \n    outs aOut, aOut\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play spectral filter\ni1 0 3 220\n\n; Play spectral smooth\ni2 4 3 330\n\n; Play spectral blur\ni3 8 4 440\n\n; Play spectral freeze\ni4 13 4 392\n\n; Play spectral mix\n; Format: start dur freq1 freq2\ni5 18 3 220 330\ni5 21 3 294 440\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates spectral morphing and cross-synthesis", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ngiSine ftgen 1, 0, 16384, 10, 1\ngiSaw ftgen 2, 0, 16384, 10, 1, 0.5, 0.3, 0.25, 0.2, 0.16\ngiSquare ftgen 3, 0, 16384, 10, 1, 0, 0.3, 0, 0.2, 0, 0.14\n\ninstr 1\n    ; pvsmorph opcode: fsig pvsmorph fsig1, fsig2, kampint, kfrqint\n    ; pvsmorph morphs between two spectral signals\n    ; fsig1, fsig2 - input spectra\n    ; kampint - amplitude interpolation (0=sig1, 1=sig2)\n    ; kfrqint - frequency interpolation (0=sig1, 1=sig2)\n    \n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Two sources with different timbres\n    aSource1 poscil iAmp, iFreq, giSaw\n    aSource2 poscil iAmp, iFreq, giSquare\n    \n    ; Analyze\n    fSig1 pvsanal aSource1, 2048, 256, 2048, 1\n    fSig2 pvsanal aSource2, 2048, 256, 2048, 1\n    \n    ; Morph from source1 to source2\n    kMorph linseg 0, p3, 1\n    \n    fMorph pvsmorph fSig1, fSig2, kMorph, kMorph\n    \n    ; Resynthesize\n    aOut pvsynth fMorph\n    \n    outs aOut, aOut\nendin\n\ninstr 2\n    ; Independent amplitude and frequency morphing\n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Two sources\n    aSource1 poscil iAmp, iFreq, giSaw\n    aSource2 poscil iAmp, iFreq*1.5, giSine\n    \n    ; Analyze\n    fSig1 pvsanal aSource1, 2048, 256, 2048, 1\n    fSig2 pvsanal aSource2, 2048, 256, 2048, 1\n    \n    ; Different morph rates for amp and freq\n    kAmpMorph linseg 0, p3*0.5, 1, p3*0.5, 0\n    kFreqMorph linseg 0, p3, 1\n    \n    fMorph pvsmorph fSig1, fSig2, kAmpMorph, kFreqMorph\n    \n    ; Resynthesize\n    aOut pvsynth fMorph\n    \n    outs aOut, aOut\nendin\n\ninstr 3\n    ; pvscross opcode: fsig pvscross fsrc, fdest, kamp1, kamp2\n    ; pvscross performs spectral cross-synthesis\n    ; fsrc - source spectrum (takes amplitudes)\n    ; fdest - destination spectrum (takes frequencies)\n    ; kamp1 - source amplitude scaling\n    ; kamp2 - destination amplitude scaling\n    \n    iAmp = 0.4\n    \n    ; Source: rich harmonic content\n    iFreq1 = p4\n    aSource poscil iAmp, iFreq1, giSaw\n    \n    ; Destination: different pitch\n    iFreq2 = p5\n    aDest poscil iAmp, iFreq2, giSine\n    \n    ; Analyze\n    fSource pvsanal aSource, 2048, 256, 2048, 1\n    fDest pvsanal aDest, 2048, 256, 2048, 1\n    \n    ; Cross-synthesis\n    kAmp1 = 1\n    kAmp2 = 0.5\n    fCross pvscross fSource, fDest, kAmp1, kAmp2\n    \n    ; Resynthesize\n    aOut pvsynth fCross\n    \n    outs aOut, aOut\nendin\n\ninstr 4\n    ; Dynamic cross-synthesis\n    iAmp = 0.4\n    \n    ; Source with changing frequency\n    kFreq1 expseg 220, p3, 880\n    aSource poscil iAmp, kFreq1, giSaw\n    \n    ; Destination\n    iFreq2 = 330\n    aDest poscil iAmp, iFreq2, giSquare\n    \n    ; Analyze\n    fSource pvsanal aSource, 2048, 256, 2048, 1\n    fDest pvsanal aDest, 2048, 256, 2048, 1\n    \n    ; Cross with changing balance\n    kBalance linseg 1, p3, 0\n    kAmp2 = 1 - kBalance\n    \n    fCross pvscross fSource, fDest, kBalance, kAmp2\n    \n    ; Resynthesize\n    aOut pvsynth fCross\n    \n    outs aOut, aOut\nendin\n\ninstr 5\n    ; pvoc opcode: ares pvoc ktimpnt, kfmod, ifilcod [, ispecwp] [, iextractmode]\n    ; pvoc performs phase vocoding from analysis file\n    ; ktimpnt - time pointer\n    ; kfmod - frequency scaling\n    ; ifilcod - analysis file\n    \n    ; Note: pvoc typically reads from pre-analyzed files\n    ; This example shows the basic concept\n    \n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Generate and analyze source\n    aSource poscil iAmp, iFreq, giSaw\n    fSig pvsanal aSource, 2048, 256, 2048, 1\n    \n    ; Resynthesize with time/pitch manipulation\n    aOut pvsynth fSig\n    \n    outs aOut, aOut\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play basic morph\ni1 0 4 220\n\n; Play independent morph\ni2 5 4 330\n\n; Play cross-synthesis\n; Format: start dur source_freq dest_freq\ni3 10 3 220 440\ni3 13 3 330 220\n\n; Play dynamic cross-synthesis\ni4 17 4 0\n\n; Play pvoc\ni5 22 3 294\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates advanced spectral techniques with buffering", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\ngiSaw ftgen 1, 0, 16384, 10, 1, 0.5, 0.3, 0.25, 0.2, 0.16, 0.14\n\ninstr 1\n    ; pvsbuffer opcode: kframes pvsbuffer fsig, ilength\n    ; pvsbuffer creates a circular buffer for spectral data\n    ; fsig - input spectrum\n    ; ilength - buffer length in seconds\n    \n    ; pvsbufread opcode: fsig pvsbufread ktimpnt, kfreqscale, ihandle [, ibufno] [, imode]\n    ; pvsbufread reads from spectral buffer\n    ; ktimpnt - time pointer (0-1)\n    ; kfreqscale - frequency scaling\n    ; ihandle - buffer handle from pvsbuffer\n    \n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Source\n    aSource poscil iAmp, iFreq, giSaw\n    \n    ; Analyze\n    fSig pvsanal aSource, 2048, 256, 2048, 1\n    \n    ; Create buffer (2 seconds)\n    kFrames pvsbuffer fSig, 2\n    \n    ; Read from buffer with time scrubbing\n    kTime phasor 0.5\n    kFreqScale = 1\n    fRead pvsbufread kTime, kFreqScale, kFrames\n    \n    ; Resynthesize\n    aOut pvsynth fRead\n    \n    outs aOut, aOut\nendin\n\ninstr 2\n    ; Spectral freeze with buffer\n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Source\n    aSource poscil iAmp, iFreq, giSaw\n    \n    ; Analyze\n    fSig pvsanal aSource, 2048, 256, 2048, 1\n    \n    ; Freeze at specific time\n    kFreezeTime = 0.5\n    kFreezeAmp linseg 0, p3*0.3, 0, 0.01, 1, p3*0.69, 1\n    kFreezeFreq = kFreezeAmp\n    \n    fFreeze pvsfreeze fSig, kFreezeAmp, kFreezeFreq\n    \n    ; Resynthesize\n    aOut pvsynth fFreeze\n    \n    outs aOut, aOut\nendin\n\ninstr 3\n    ; Multi-layer spectral processing\n    iAmp = 0.35\n    iFreq = p4\n    \n    ; Source\n    aSource poscil iAmp, iFreq, giSaw\n    \n    ; Analyze\n    fSig pvsanal aSource, 2048, 256, 2048, 1\n    \n    ; Layer 1: original\n    aOut1 pvsynth fSig\n    \n    ; Layer 2: blurred\n    fBlur pvsblur fSig, 0.1, 1\n    aOut2 pvsynth fBlur\n    \n    ; Layer 3: smoothed\n    fSmooth pvsmooth fSig, 0.5, 0.5\n    aOut3 pvsynth fSmooth\n    \n    ; Mix layers\n    aMix = aOut1*0.5 + aOut2*0.3 + aOut3*0.2\n    \n    outs aMix, aMix\nendin\n\ninstr 4\n    ; Spectral time-stretching\n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Source with time-varying content\n    kMod phasor 2\n    aSource poscil iAmp, iFreq*(1+kMod), giSaw\n    \n    ; Analyze\n    fSig pvsanal aSource, 2048, 256, 2048, 1\n    \n    ; Buffer\n    kFrames pvsbuffer fSig, 3\n    \n    ; Read at slower speed (time stretch)\n    kTime phasor 0.3\n    fStretch pvsbufread kTime, 1, kFrames\n    \n    ; Resynthesize\n    aOut pvsynth fStretch\n    \n    outs aOut, aOut\nendin\n\ninstr 5\n    ; Spectral pitch shifting\n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Source\n    aSource poscil iAmp, iFreq, giSaw\n    \n    ; Analyze\n    fSig pvsanal aSource, 2048, 256, 2048, 1\n    \n    ; Buffer\n    kFrames pvsbuffer fSig, 2\n    \n    ; Read with frequency scaling\n    kTime phasor 1\n    kFreqScale linseg 1, p3, 2\n    fPitchShift pvsbufread kTime, kFreqScale, kFrames\n    \n    ; Resynthesize\n    aOut pvsynth fPitchShift\n    \n    outs aOut, aOut\nendin\n\ninstr 6\n    ; Complex spectral effects chain\n    iAmp = 0.35\n    iFreq = p4\n    \n    ; Rich source\n    aSource poscil iAmp, iFreq, giSaw\n    \n    ; Analyze\n    fSig pvsanal aSource, 2048, 256, 2048, 1\n    \n    ; Blur\n    fBlur pvsblur fSig, 0.15, 2\n    \n    ; Smooth\n    fSmooth pvsmooth fBlur, 0.3, 0.4\n    \n    ; Create second signal for mixing\n    aSource2 poscil iAmp*0.5, iFreq*1.5, 1\n    fSig2 pvsanal aSource2, 2048, 256, 2048, 1\n    \n    ; Mix\n    fMix pvsmix fSmooth, fSig2\n    \n    ; Resynthesize\n    aOut pvsynth fMix\n    \n    outs aOut, aOut\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play buffer scrubbing\ni1 0 4 220\n\n; Play spectral freeze\ni2 5 4 330\n\n; Play multi-layer\ni3 10 3 440\n\n; Play time-stretching\ni4 14 5 294\n\n; Play pitch shifting\ni5 20 4 392\n\n; Play effects chain\ni6 25 4 220\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
