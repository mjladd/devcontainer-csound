{"instruction": "Write a CSound instrument that demonstrates the grain opcode for basic granular synthesis", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 1\n0dbfs = 1\n\n; Function tables\ngiSine ftgen 1, 0, 8192, 10, 1\ngiHann ftgen 2, 0, 8192, 20, 2, 1\n\ninstr 1\n    ; grain opcode: ares grain xamp, xpitch, xdens, kampoff, kpitchoff, kgdur, igfn, iwfn, imgdur [, igrnd]\n    ; grain generates granular synthesis from an oscillator\n    ; xamp - amplitude\n    ; xpitch - grain pitch (Hz)\n    ; xdens - grain density (grains per second)\n    ; kampoff - amplitude offset (randomization)\n    ; kpitchoff - pitch offset (randomization in Hz)\n    ; kgdur - grain duration (seconds)\n    ; igfn - grain waveform function table\n    ; iwfn - window function table\n    ; imgdur - max grain duration\n    ; igrnd - random seed (optional)\n    \n    ; Amplitude envelope\n    kAmp linseg 0, 0.5, 0.4, p3-1, 0.4, 0.5, 0\n    \n    ; Granular parameters\n    kPitch = 440\n    kDens = 50      ; 50 grains per second\n    kAmpOff = 0.1   ; Slight amplitude randomization\n    kPitchOff = 5   ; 5 Hz pitch randomization\n    kGDur = 0.05    ; 50ms grain duration\n    iMaxGDur = 0.1\n    \n    ; Generate granular texture\n    aGrain grain kAmp, kPitch, kDens, kAmpOff, kPitchOff, kGDur, giSine, giHann, iMaxGDur\n    \n    out aGrain\nendin\n\ninstr 2\n    ; Cloud texture with variable density\n    kAmp linseg 0, 0.3, 0.35, p3-0.6, 0.35, 0.3, 0\n    \n    kPitch = 220\n    \n    ; Density changes over time\n    kDens linseg 20, p3, 100\n    \n    kAmpOff = 0.2\n    kPitchOff = 10\n    kGDur = 0.08\n    iMaxGDur = 0.15\n    \n    aGrain grain kAmp, kPitch, kDens, kAmpOff, kPitchOff, kGDur, giSine, giHann, iMaxGDur\n    \n    out aGrain\nendin\n\ninstr 3\n    ; Sweeping pitch cloud\n    kAmp linseg 0, 0.2, 0.3, p3-0.4, 0.3, 0.2, 0\n    \n    ; Pitch sweeps\n    kPitch expseg 200, p3, 1000\n    \n    kDens = 60\n    kAmpOff = 0.15\n    kPitchOff linseg 5, p3, 50  ; Increasing randomization\n    kGDur = 0.06\n    iMaxGDur = 0.12\n    \n    aGrain grain kAmp, kPitch, kDens, kAmpOff, kPitchOff, kGDur, giSine, giHann, iMaxGDur\n    \n    out aGrain\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play basic granular\ni1 0 5\n\n; Play variable density\ni2 6 6\n\n; Play pitch sweep\ni3 13 5\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates the grain2 opcode for more complex granular synthesis", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function tables\ngiSine ftgen 1, 0, 8192, 10, 1\ngiHann ftgen 2, 0, 8192, 20, 2, 1\n\ninstr 1\n    ; grain2 opcode: ares grain2 kcps, kfmd, kgdur, iovrlp, kfn, iwfn, kfrpow, kprpow [, iseed] [, imode]\n    ; grain2 provides more control over grain parameters\n    ; kcps - frequency (Hz)\n    ; kfmd - frequency deviation (cents)\n    ; kgdur - grain duration (milliseconds)\n    ; iovrlp - maximum overlap (number of grains)\n    ; kfn - grain waveform table\n    ; iwfn - window function\n    ; kfrpow - frequency distribution randomness (0-1)\n    ; kprpow - phase distribution randomness (0-1)\n    ; iseed - random seed (optional)\n    ; imode - mode flag (optional)\n    \n    ; Amplitude envelope\n    kAmp madsr 0.1, 0.3, 0.6, 0.5\n    \n    kCPS = 330\n    kFMD = 50       ; 50 cents deviation\n    kGDur = 80      ; 80ms grains\n    iOvrlp = 10     ; Up to 10 overlapping grains\n    kFRPow = 0.5    ; Medium randomness\n    kPRPow = 0.3\n    \n    aGrain grain2 kCPS, kFMD, kGDur, iOvrlp, giSine, giHann, kFRPow, kPRPow\n    \n    outs aGrain*kAmp*0.3, aGrain*kAmp*0.3\nendin\n\ninstr 2\n    ; High-density granular texture\n    kAmp linseg 0, 0.5, 0.3, p3-1, 0.3, 0.5, 0\n    \n    kCPS = 220\n    kFMD = 100      ; Larger pitch spread\n    kGDur = 40      ; Shorter grains\n    iOvrlp = 20     ; High overlap\n    kFRPow = 0.8    ; High randomness\n    kPRPow = 0.6\n    \n    aGrain grain2 kCPS, kFMD, kGDur, iOvrlp, giSine, giHann, kFRPow, kPRPow\n    \n    outs aGrain*kAmp, aGrain*kAmp\nendin\n\ninstr 3\n    ; Evolving granular pad\n    kAmp linseg 0, 1, 0.25, p3-2, 0.25, 1, 0\n    \n    kCPS = 165\n    kFMD linseg 20, p3, 200    ; Increasing spread\n    kGDur linseg 100, p3, 30   ; Decreasing grain size\n    iOvrlp = 15\n    kFRPow linseg 0.2, p3, 0.9\n    kPRPow = 0.5\n    \n    aGrain grain2 kCPS, kFMD, kGDur, iOvrlp, giSine, giHann, kFRPow, kPRPow\n    \n    outs aGrain*kAmp, aGrain*kAmp\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play basic grain2\ni1 0 4\n\n; Play high-density\ni2 5 5\n\n; Play evolving pad\ni3 11 10\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates the grain3 opcode for pitch-synchronous granular synthesis", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function tables\ngiSine ftgen 1, 0, 8192, 10, 1\ngiHann ftgen 2, 0, 8192, 20, 2, 1\n\ninstr 1\n    ; grain3 opcode: ares grain3 kcps, kphs, kfmd, kpmd, kgdur, kdens, imaxovr, kfn, iwfn, kfrpow, kprpow [, iseed] [, imode]\n    ; grain3 allows phase control for pitch-synchronous granulation\n    ; kcps - frequency (Hz)\n    ; kphs - phase offset (0-1)\n    ; kfmd - frequency deviation (cents)\n    ; kpmd - phase deviation (0-1)\n    ; kgdur - grain duration (milliseconds)\n    ; kdens - density (grains per second)\n    ; imaxovr - maximum overlap\n    ; kfn - grain waveform\n    ; iwfn - window function\n    ; kfrpow - frequency randomness\n    ; kprpow - phase randomness\n    ; iseed - random seed (optional)\n    ; imode - mode (optional)\n    \n    ; Amplitude envelope\n    kAmp madsr 0.1, 0.2, 0.6, 0.4\n    \n    kCPS = 440\n    kPhs = 0        ; Phase offset\n    kFMD = 30       ; Frequency deviation\n    kPMD = 0.1      ; Phase deviation\n    kGDur = 60      ; Grain duration\n    kDens = 100     ; Grain density\n    iMaxOvr = 10\n    kFRPow = 0.4\n    kPRPow = 0.3\n    \n    aGrain grain3 kCPS, kPhs, kFMD, kPMD, kGDur, kDens, iMaxOvr, giSine, giHann, kFRPow, kPRPow\n    \n    outs aGrain*kAmp*0.3, aGrain*kAmp*0.3\nendin\n\ninstr 2\n    ; Phase-controlled granular synthesis\n    kAmp linseg 0, 0.3, 0.3, p3-0.6, 0.3, 0.3, 0\n    \n    kCPS = 220\n    \n    ; LFO controls phase\n    kPhs oscili 0.5, 0.5, giSine\n    kPhs = 0.5 + kPhs\n    \n    kFMD = 40\n    kPMD = 0.2\n    kGDur = 50\n    kDens = 80\n    iMaxOvr = 12\n    kFRPow = 0.5\n    kPRPow = 0.4\n    \n    aGrain grain3 kCPS, kPhs, kFMD, kPMD, kGDur, kDens, iMaxOvr, giSine, giHann, kFRPow, kPRPow\n    \n    outs aGrain*kAmp, aGrain*kAmp\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play pitch-synchronous\ni1 0 4\n\n; Play phase-controlled\ni2 5 6\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates the granule opcode for advanced granular control", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function tables\ngiSine ftgen 1, 0, 8192, 10, 1\ngiHann ftgen 2, 0, 8192, 20, 2, 1\ngiSound ftgen 3, 0, 131072, 1, \"sample.wav\", 0, 0, 0\n\ninstr 1\n    ; granule opcode: ares granule xamp, ivoice, iratio, imode, ithd, ifn, ipshift, igskip, \n    ;                         igskip_os, ilength, kgap, igap_os, kgsize, igsize_os, iatt, idec \n    ;                         [, iseed] [, ipitch1] [, ipitch2] [, ipitch3] [, ipitch4] [, ifnenv]\n    ; granule provides comprehensive granular synthesis control\n    ; xamp - amplitude\n    ; ivoice - number of voices\n    ; iratio - frequency ratio\n    ; imode - grain mode (0=soundfile, 1=waveform, 2=FM)\n    ; ithd - pitch threshold\n    ; ifn - source function table\n    ; ipshift - pitch shift\n    ; igskip - grain skip\n    ; igskip_os - skip offset\n    ; ilength - grain length\n    ; kgap - gap between grains\n    ; igap_os - gap offset\n    ; kgsize - grain size\n    ; igsize_os - size offset\n    ; iatt, idec - attack/decay times\n    \n    ; Amplitude envelope\n    kAmp madsr 0.05, 0.2, 0.6, 0.4\n    \n    ; Basic granule with waveform mode\n    iVoice = 8\n    iRatio = 1\n    iMode = 1       ; Waveform mode\n    iThd = 0\n    iPShift = 0\n    iGSkip = 0\n    iGSkipOS = 0\n    iLength = 8192\n    kGap = 0.01     ; 10ms gap\n    iGapOS = 0.005\n    kGSize = 0.05   ; 50ms grain size\n    iGSizeOS = 0.02\n    iAtt = 0.3\n    iDec = 0.7\n    \n    aGran granule kAmp*0.3, iVoice, iRatio, iMode, iThd, giSine, iPShift, iGSkip, \\\n                  iGSkipOS, iLength, kGap, iGapOS, kGSize, iGSizeOS, iAtt, iDec\n    \n    outs aGran, aGran\nendin\n\ninstr 2\n    ; Multi-voice granular texture\n    kAmp linseg 0, 0.5, 0.25, p3-1, 0.25, 0.5, 0\n    \n    iVoice = 16     ; More voices for denser texture\n    iRatio = 1\n    iMode = 1\n    iThd = 0\n    iPShift = 0\n    iGSkip = 0\n    iGSkipOS = 0\n    iLength = 8192\n    \n    ; Variable gap and size\n    kGap linseg 0.02, p3, 0.005\n    iGapOS = 0.01\n    kGSize linseg 0.08, p3, 0.03\n    iGSizeOS = 0.03\n    iAtt = 0.3\n    iDec = 0.7\n    \n    aGran granule kAmp, iVoice, iRatio, iMode, iThd, giSine, iPShift, iGSkip, \\\n                  iGSkipOS, iLength, kGap, iGapOS, kGSize, iGSizeOS, iAtt, iDec\n    \n    outs aGran, aGran\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play basic granule\ni1 0 5\n\n; Play multi-voice\ni2 6 8\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates the syncgrain opcode for synchronous granular synthesis", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function tables\ngiSound ftgen 1, 0, 131072, 10, 1, 0.5, 0.3, 0.25, 0.2\ngiHann ftgen 2, 0, 8192, 20, 2, 1\n\ninstr 1\n    ; syncgrain opcode: ares syncgrain kamp, kfreq, kpitch, kgrsize, kprate, ifun1, ifun2, iolaps\n    ; syncgrain performs synchronous granular synthesis\n    ; kamp - amplitude\n    ; kfreq - grain frequency (grains per second)\n    ; kpitch - pitch multiplier\n    ; kgrsize - grain size (in samples or seconds depending on kfreq)\n    ; kprate - starting phase in table (0-1)\n    ; ifun1 - source function table\n    ; ifun2 - grain envelope function\n    ; iolaps - maximum overlaps\n    \n    ; Amplitude envelope\n    kAmp madsr 0.05, 0.2, 0.6, 0.4\n    \n    kFreq = 50      ; 50 grains per second\n    kPitch = 1      ; Original pitch\n    kGrSize = 0.04  ; 40ms grains\n    kPRate = 0      ; Start at beginning\n    iOlaps = 10\n    \n    aGrain syncgrain kAmp*0.3, kFreq, kPitch, kGrSize, kPRate, giSound, giHann, iOlaps\n    \n    outs aGrain, aGrain\nendin\n\ninstr 2\n    ; Time-stretching with syncgrain\n    kAmp linseg 0, 0.3, 0.3, p3-0.6, 0.3, 0.3, 0\n    \n    kFreq = 80      ; Higher density\n    kPitch = 1\n    kGrSize = 0.05\n    \n    ; Slowly scan through table\n    kPRate linseg 0, p3, 1\n    iOlaps = 12\n    \n    aGrain syncgrain kAmp, kFreq, kPitch, kGrSize, kPRate, giSound, giHann, iOlaps\n    \n    outs aGrain, aGrain\nendin\n\ninstr 3\n    ; Pitch-shifting granular\n    kAmp madsr 0.05, 0.2, 0.6, 0.4\n    \n    kFreq = 60\n    \n    ; Pitch changes over time\n    kPitch linseg 0.5, p3, 2\n    \n    kGrSize = 0.06\n    kPRate = 0\n    iOlaps = 10\n    \n    aGrain syncgrain kAmp*0.3, kFreq, kPitch, kGrSize, kPRate, giSound, giHann, iOlaps\n    \n    outs aGrain, aGrain\nendin\n\ninstr 4\n    ; Frozen granular texture\n    kAmp linseg 0, 0.5, 0.25, p3-1, 0.25, 0.5, 0\n    \n    kFreq = 100     ; High density\n    kPitch = 1\n    kGrSize = 0.03  ; Short grains\n    \n    ; Stay at one position in table\n    kPRate = 0.3\n    iOlaps = 20\n    \n    aGrain syncgrain kAmp, kFreq, kPitch, kGrSize, kPRate, giSound, giHann, iOlaps\n    \n    outs aGrain, aGrain\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play basic syncgrain\ni1 0 3\n\n; Play time-stretching\ni2 4 8\n\n; Play pitch-shifting\ni3 13 5\n\n; Play frozen texture\ni4 19 6\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates the syncloop opcode for synchronized loop-based granulation", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function tables\ngiSound ftgen 1, 0, 131072, 10, 1, 0.5, 0.3, 0.25, 0.2, 0.16, 0.14, 0.12\ngiHann ftgen 2, 0, 8192, 20, 2, 1\n\ninstr 1\n    ; syncloop opcode: ares syncloop kfreq, kpitch, kgrsize, kprate, klstart, klend, ifun1, ifun2, iolaps\n    ; syncloop is like syncgrain but with loop points\n    ; kfreq - grain frequency (Hz)\n    ; kpitch - pitch multiplier\n    ; kgrsize - grain size\n    ; kprate - read rate through loop\n    ; klstart - loop start point (0-1)\n    ; klend - loop end point (0-1)\n    ; ifun1 - source function\n    ; ifun2 - grain envelope\n    ; iolaps - maximum overlaps\n    \n    ; Amplitude envelope\n    kAmp madsr 0.05, 0.2, 0.6, 0.4\n    \n    kFreq = 60\n    kPitch = 1\n    kGrSize = 0.05\n    kPRate = 0.5\n    kLStart = 0.2   ; Loop from 20% into table\n    kLEnd = 0.8     ; Loop to 80% of table\n    iOlaps = 10\n    \n    aGrain syncloop kFreq, kPitch, kGrSize, kPRate, kLStart, kLEnd, giSound, giHann, iOlaps\n    \n    outs aGrain*kAmp*0.3, aGrain*kAmp*0.3\nendin\n\ninstr 2\n    ; Moving loop points\n    kAmp linseg 0, 0.3, 0.3, p3-0.6, 0.3, 0.3, 0\n    \n    kFreq = 70\n    kPitch = 1\n    kGrSize = 0.04\n    kPRate = 0.8\n    \n    ; Loop points move over time\n    kLStart linseg 0, p3, 0.5\n    kLEnd linseg 0.3, p3, 1\n    iOlaps = 12\n    \n    aGrain syncloop kFreq, kPitch, kGrSize, kPRate, kLStart, kLEnd, giSound, giHann, iOlaps\n    \n    outs aGrain*kAmp, aGrain*kAmp\nendin\n\ninstr 3\n    ; Micro-looping texture\n    kAmp madsr 0.05, 0.2, 0.6, 0.4\n    \n    kFreq = 100     ; High density\n    kPitch = 0.75\n    kGrSize = 0.02  ; Very short grains\n    kPRate = 2      ; Fast read rate\n    \n    ; Very small loop region\n    kLStart = 0.4\n    kLEnd = 0.45\n    iOlaps = 15\n    \n    aGrain syncloop kFreq, kPitch, kGrSize, kPRate, kLStart, kLEnd, giSound, giHann, iOlaps\n    \n    outs aGrain*kAmp*0.3, aGrain*kAmp*0.3\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play basic loop\ni1 0 4\n\n; Play moving loop\ni2 5 6\n\n; Play micro-loop\ni3 12 5\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates the sndwarp opcode for time-stretching and pitch-shifting", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 1\n0dbfs = 1\n\n; Function tables\ngiSound ftgen 1, 0, 131072, 10, 1, 0.5, 0.3, 0.25, 0.2\ngiHann ftgen 2, 0, 8192, 20, 2, 1\n\ninstr 1\n    ; sndwarp opcode: ares sndwarp xamp, xtimewarp, xresample, ifn1, ibeg, iwsize, \n    ;                        irandw, ioverlap, ifn2, itimemode\n    ; sndwarp performs time-stretching and pitch-shifting\n    ; xamp - amplitude\n    ; xtimewarp - time pointer (seconds or 0-1 depending on mode)\n    ; xresample - resampling factor (pitch shift)\n    ; ifn1 - source function table\n    ; ibeg - begin position in table\n    ; iwsize - window size (samples)\n    ; irandw - window randomization\n    ; ioverlap - number of overlaps\n    ; ifn2 - window function\n    ; itimemode - time mode (0=absolute time, 1=normalized 0-1)\n    \n    ; Amplitude envelope\n    kAmp madsr 0.05, 0.2, 0.6, 0.4\n    \n    ; Time pointer\n    kTime line 0, p3, 1\n    \n    ; Pitch\n    kResamp = 1     ; Original pitch\n    \n    iBeg = 0\n    iWSize = 4096\n    iRandW = 400\n    iOvrlp = 8\n    iTimeMode = 1   ; Normalized time\n    \n    aWarp sndwarp kAmp*0.4, kTime, kResamp, giSound, iBeg, iWSize, iRandW, iOvrlp, giHann, iTimeMode\n    \n    out aWarp\nendin\n\ninstr 2\n    ; Extreme time-stretching\n    kAmp linseg 0, 0.5, 0.35, p3-1, 0.35, 0.5, 0\n    \n    ; Very slow time progression\n    kTime line 0.2, p3, 0.3\n    \n    kResamp = 1\n    iBeg = 0\n    iWSize = 8192   ; Larger window for smoother stretch\n    iRandW = 800\n    iOvrlp = 16\n    iTimeMode = 1\n    \n    aWarp sndwarp kAmp, kTime, kResamp, giSound, iBeg, iWSize, iRandW, iOvrlp, giHann, iTimeMode\n    \n    out aWarp\nendin\n\ninstr 3\n    ; Pitch-shifting without time change\n    kAmp madsr 0.05, 0.2, 0.6, 0.4\n    \n    ; Normal time progression\n    kTime line 0, p3, 1\n    \n    ; Pitch shift\n    kResamp linseg 1, p3, 2  ; Up one octave\n    \n    iBeg = 0\n    iWSize = 4096\n    iRandW = 400\n    iOvrlp = 8\n    iTimeMode = 1\n    \n    aWarp sndwarp kAmp*0.4, kTime, kResamp, giSound, iBeg, iWSize, iRandW, iOvrlp, giHann, iTimeMode\n    \n    out aWarp\nendin\n\ninstr 4\n    ; Reverse with pitch shift\n    kAmp linseg 0, 0.3, 0.35, p3-0.6, 0.35, 0.3, 0\n    \n    ; Reverse playback\n    kTime line 1, p3, 0\n    \n    ; Down one octave\n    kResamp = 0.5\n    \n    iBeg = 0\n    iWSize = 4096\n    iRandW = 400\n    iOvrlp = 8\n    iTimeMode = 1\n    \n    aWarp sndwarp kAmp, kTime, kResamp, giSound, iBeg, iWSize, iRandW, iOvrlp, giHann, iTimeMode\n    \n    out aWarp\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play normal time-stretch\ni1 0 5\n\n; Play extreme stretch\ni2 6 10\n\n; Play pitch-shift\ni3 17 4\n\n; Play reverse\ni4 22 4\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates the sndwarpst opcode for stereo time-stretching", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function tables\ngiSoundL ftgen 1, 0, 131072, 10, 1, 0.5, 0.3, 0.25\ngiSoundR ftgen 2, 0, 131072, 10, 1, 0.4, 0.35, 0.2\ngiHann ftgen 3, 0, 8192, 20, 2, 1\n\ninstr 1\n    ; sndwarpst opcode: ar1, ar2 sndwarpst xamp, xtimewarp, xresample, ifn1, ifn2, ibeg, \n    ;                           iwsize, irandw, ioverlap, ifn3, itimemode\n    ; sndwarpst performs stereo time-stretching and pitch-shifting\n    ; xamp - amplitude\n    ; xtimewarp - time pointer\n    ; xresample - resampling factor\n    ; ifn1, ifn2 - source function tables (left, right)\n    ; ibeg - begin position\n    ; iwsize - window size\n    ; irandw - window randomization\n    ; ioverlap - overlaps\n    ; ifn3 - window function\n    ; itimemode - time mode\n    \n    ; Amplitude envelope\n    kAmp madsr 0.05, 0.2, 0.6, 0.4\n    \n    kTime line 0, p3, 1\n    kResamp = 1\n    \n    iBeg = 0\n    iWSize = 4096\n    iRandW = 400\n    iOvrlp = 8\n    iTimeMode = 1\n    \n    aL, aR sndwarpst kAmp*0.3, kTime, kResamp, giSoundL, giSoundR, iBeg, iWSize, iRandW, iOvrlp, giHann, iTimeMode\n    \n    outs aL, aR\nendin\n\ninstr 2\n    ; Stereo time-stretch with pitch modulation\n    kAmp linseg 0, 0.5, 0.3, p3-1, 0.3, 0.5, 0\n    \n    ; Slow time\n    kTime line 0.1, p3, 0.4\n    \n    ; Wobbling pitch\n    kLFO oscili 0.1, 0.5, 3\n    kResamp = 1 + kLFO\n    \n    iBeg = 0\n    iWSize = 8192\n    iRandW = 800\n    iOvrlp = 16\n    iTimeMode = 1\n    \n    aL, aR sndwarpst kAmp, kTime, kResamp, giSoundL, giSoundR, iBeg, iWSize, iRandW, iOvrlp, giHann, iTimeMode\n    \n    outs aL, aR\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play stereo warp\ni1 0 5\n\n; Play with modulation\ni2 6 10\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates the partikkel opcode for advanced granular synthesis", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function tables\ngiSine ftgen 1, 0, 8192, 10, 1\ngiCosine ftgen 2, 0, 8193, 9, 1, 1, 90\ngiHann ftgen 3, 0, 8192, 20, 2, 1\n\ninstr 1\n    ; partikkel is a very complex opcode with many parameters\n    ; This demonstrates basic usage\n    ; partikkel provides complete control over granular synthesis\n    \n    ; Amplitude envelope\n    kAmp linseg 0, 0.5, 0.25, p3-1, 0.25, 0.5, 0\n    \n    ; Basic partikkel parameters\n    kgrfreq = 100           ; Grain frequency\n    kdistribution = 0       ; Periodic grain distribution\n    idisttab = -1           ; No distribution table\n    async = 0               ; Synchronous mode\n    kenv2amt = 0            ; Grain envelope amount\n    ienv2tab = -1           ; No second envelope\n    ienv_attack = -1        ; Attack time\n    ienv_decay = -1         ; Decay time  \n    ksustain_amt = 0.5      ; Sustain amount\n    ka_d_ratio = 0.5        ; Attack/decay ratio\n    kduration = 0.05        ; Grain duration (50ms)\n    kamp = kAmp             ; Amplitude\n    igainmasks = -1         ; No gain masking\n    \n    ; Additional parameters (simplified)\n    kwavfreq = 440          ; Waveform frequency\n    ksweepshape = 0         ; No sweep\n    iwavfreqstarttab = -1\n    iwavfreqendtab = -1\n    awavfm = 0\n    ifmamptab = -1\n    kfmenv = 0\n    icosine = giCosine      ; Cosine table\n    kTrainCps = kgrfreq     ; Grain train frequency\n    knumpartials = 1        ; Number of partials\n    kchroma = 1             ; Chroma\n    ichannelmasks = -1      ; No channel masking\n    krandommask = 0         ; No random masking\n    \n    ; Waveform and related tables\n    kwaveform1 = giSine\n    kwaveform2 = giSine  \n    kwaveform3 = giSine\n    kwaveform4 = giSine\n    iwaveamptab = -1\n    \n    ; Spatial parameters\n    asamplepos1 = 0\n    asamplepos2 = 0\n    asamplepos3 = 0  \n    asamplepos4 = 0\n    kwavekey1 = 1\n    kwavekey2 = 1\n    kwavekey3 = 1\n    kwavekey4 = 1\n    imax_grains = 100\n    \n    ; Generate grains\n    a1, a2, a3, a4 partikkel kgrfreq, kdistribution, idisttab, async, kenv2amt, \\\n        ienv2tab, ienv_attack, ienv_decay, ksustain_amt, ka_d_ratio, kduration, \\\n        kamp, igainmasks, kwavfreq, ksweepshape, iwavfreqstarttab, iwavfreqendtab, \\\n        awavfm, ifmamptab, kfmenv, icosine, kTrainCps, knumpartials, kchroma, \\\n        ichannelmasks, krandommask, kwaveform1, kwaveform2, kwaveform3, kwaveform4, \\\n        iwaveamptab, asamplepos1, asamplepos2, asamplepos3, asamplepos4, \\\n        kwavekey1, kwavekey2, kwavekey3, kwavekey4, imax_grains\n    \n    ; Mix outputs\n    aOut = (a1 + a2 + a3 + a4) * 0.25\n    \n    outs aOut, aOut\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play partikkel granular\ni1 0 8\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates practical granular synthesis techniques", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function tables\ngiSine ftgen 1, 0, 8192, 10, 1\ngiHann ftgen 2, 0, 8192, 20, 2, 1\ngiSound ftgen 3, 0, 131072, 10, 1, 0.5, 0.3, 0.25, 0.2\n\ninstr 1\n    ; Granular clouds with syncgrain\n    kAmp linseg 0, 1, 0.25, p3-2, 0.25, 1, 0\n    \n    ; Multiple layers of grains at different densities\n    kFreq1 = 40\n    kFreq2 = 60\n    kFreq3 = 90\n    \n    kPitch = 1\n    kGrSize = 0.06\n    kPRate = 0\n    iOlaps = 10\n    \n    aGrain1 syncgrain kAmp*0.35, kFreq1, kPitch, kGrSize, kPRate, giSound, giHann, iOlaps\n    aGrain2 syncgrain kAmp*0.25, kFreq2, kPitch*1.5, kGrSize*0.7, kPRate, giSound, giHann, iOlaps\n    aGrain3 syncgrain kAmp*0.15, kFreq3, kPitch*2, kGrSize*0.5, kPRate, giSound, giHann, iOlaps\n    \n    aOut = aGrain1 + aGrain2 + aGrain3\n    \n    outs aOut*0.5, aOut*0.5\nendin\n\ninstr 2\n    ; Rhythmic granular patterns\n    kAmp madsr 0.01, 0.08, 0.5, 0.3\n    \n    ; Modulated grain frequency for rhythm\n    kLFO oscili 30, 2, giSine\n    kFreq = 60 + kLFO\n    \n    kPitch = 1\n    kGrSize = 0.03\n    kPRate linseg 0, p3, 0.5\n    iOlaps = 12\n    \n    aGrain syncgrain kAmp*0.3, kFreq, kPitch, kGrSize, kPRate, giSound, giHann, iOlaps\n    \n    outs aGrain, aGrain\nendin\n\ninstr 3\n    ; Spectral freeze using high-density grains\n    kAmp linseg 0, 0.5, 0.2, p3-1, 0.2, 0.5, 0\n    \n    kFreq = 200     ; Very high density\n    kPitch = 1\n    kGrSize = 0.015 ; Very short grains\n    kPRate = 0.35   ; Fixed position = freeze\n    iOlaps = 30\n    \n    aGrain syncgrain kAmp, kFreq, kPitch, kGrSize, kPRate, giSound, giHann, iOlaps\n    \n    ; Add some filtering\n    aFilt moogladder aGrain, 2000, 0.3\n    \n    outs aFilt, aFilt\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play granular cloud\ni1 0 10\n\n; Play rhythmic grains\ni2 11 6\ni2 12 6\n\n; Play spectral freeze\ni3 18 8\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
