{"instruction": "Write a CSound instrument that demonstrates the wgbow opcode for waveguide bowed string synthesis", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function table\ngiSine ftgen 1, 0, 8192, 10, 1\n\ninstr 1\n    ; wgbow opcode: ares wgbow kamp, kfreq, kpres, krat, kvibf, kvamp [, ifn] [, iminfreq]\n    ; wgbow implements a physical model of a bowed string using waveguide synthesis\n    ; kamp - amplitude\n    ; kfreq - frequency in Hz\n    ; kpres - bow pressure (0-1, typically 0.3-0.5)\n    ; krat - position of bow on string (0-1, 0=nut, 1=bridge)\n    ; kvibf - vibrato frequency in Hz\n    ; kvamp - vibrato amplitude (0-1)\n    ; ifn - table for vibrato waveform (default sine)\n    ; iminfreq - minimum expected frequency (for buffer allocation)\n    \n    ; Amplitude envelope\n    kAmp madsr 0.2, 0.1, 0.7, 0.3\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Bow parameters\n    kPres = 0.4     ; Moderate bow pressure\n    kRat = 0.15     ; Bow position near nut\n    kVibF = 5       ; 5 Hz vibrato\n    kVibAmp = 0.005 ; Subtle vibrato\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 2\n    ; Expressive bowing with dynamic pressure\n    kAmp madsr 0.3, 0.2, 0.6, 0.4\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Varying bow pressure for expression\n    kPres linseg 0.3, p3*0.3, 0.5, p3*0.4, 0.45, p3*0.3, 0.35\n    \n    kRat = 0.2\n    kVibF = 6\n    kVibAmp = 0.008\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 3\n    ; Different bow positions\n    kAmp madsr 0.2, 0.1, 0.7, 0.3\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Bow position from score parameter\n    kRat = p5\n    kPres = 0.4\n    kVibF = 5\n    kVibAmp = 0.005\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 4\n    ; Intense vibrato for emotional expression\n    kAmp madsr 0.3, 0.2, 0.6, 0.4\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    kPres = 0.45\n    kRat = 0.15\n    \n    ; Intense vibrato\n    kVibF = 6.5\n    kVibAmp = 0.02  ; Wide vibrato\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 5\n    ; Portamento between notes\n    kAmp madsr 0.2, 0.1, 0.7, 0.3\n    \n    iFreq1 = p4\n    iFreq2 = p5\n    \n    ; Smooth glissando\n    kFreq linseg iFreq1, p3, iFreq2\n    \n    kPres = 0.4\n    kRat = 0.2\n    kVibF = 5.5\n    kVibAmp = 0.007\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 6\n    ; Sul ponticello (bowing near bridge)\n    kAmp madsr 0.2, 0.1, 0.6, 0.3\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    kPres = 0.5     ; Higher pressure for sul pont\n    kRat = 0.9      ; Very close to bridge\n    kVibF = 4\n    kVibAmp = 0.003 ; Minimal vibrato\n    \n    aBow wgbow kAmp*0.4, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play basic bowed string\ni1 0 3 440\ni1 3.5 3 330\n\n; Play expressive bowing\ni2 7.5 4 523\n\n; Play different bow positions\n; Format: start dur freq bow_position\ni3 12.5 2 330 0.1   ; Near nut\ni3 14.5 2 330 0.5   ; Center\ni3 16.5 2 330 0.8   ; Near bridge\n\n; Play intense vibrato\ni4 20 4 392\n\n; Play portamento\n; Format: start dur freq1 freq2\ni5 25 3 220 330\ni5 28 3 330 440\n\n; Play sul ponticello\ni6 32 3 523\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates the wgbowedbar opcode for bowed bar physical model", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function table\ngiSine ftgen 1, 0, 8192, 10, 1\n\ninstr 1\n    ; wgbowedbar opcode: ares wgbowedbar kamp, kfreq, kpos, kbowpres, kgain [, iconst] [, itvel] [, ibowpos] [, ilow]\n    ; wgbowedbar implements a physical model of a bowed metal bar (like a vibraphone or marimba bar)\n    ; kamp - amplitude\n    ; kfreq - frequency in Hz\n    ; kpos - strike position (0-1)\n    ; kbowpres - bow pressure (0-1)\n    ; kgain - overall gain (typically 0.8-0.99)\n    ; iconst - integration constant (default 0.1)\n    ; itvel - table velocity (default 0.0)\n    ; ibowpos - bow position (default 0)\n    ; ilow - lowest frequency (for buffer size)\n    \n    ; Amplitude envelope\n    kAmp madsr 0.1, 0.05, 0.8, 0.2\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Bar parameters\n    kPos = 0.2      ; Strike/bow position\n    kBowPres = 0.5  ; Bow pressure\n    kGain = 0.95    ; High gain for sustain\n    \n    aBar wgbowedbar kAmp*0.4, kFreq, kPos, kBowPres, kGain\n    \n    outs aBar, aBar\nendin\n\ninstr 2\n    ; Vibraphone-like sound\n    kAmp madsr 0.05, 0.02, 0.9, 0.3\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    kPos = 0.15     ; Strike position for vibraphone\n    kBowPres = 0.4\n    kGain = 0.98    ; Very high sustain\n    \n    aBar wgbowedbar kAmp*0.35, kFreq, kPos, kBowPres, kGain\n    \n    ; Add vibrato like vibraphone motor\n    kVib oscili 0.3, 6, giSine\n    kVib = 1 + kVib*0.05\n    \n    outs aBar*kVib, aBar*kVib\nendin\n\ninstr 3\n    ; Dynamic bow pressure\n    kAmp madsr 0.2, 0.1, 0.7, 0.3\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    kPos = 0.25\n    \n    ; Varying bow pressure\n    kBowPres linseg 0.2, p3*0.3, 0.6, p3*0.4, 0.5, p3*0.3, 0.3\n    \n    kGain = 0.92\n    \n    aBar wgbowedbar kAmp*0.4, kFreq, kPos, kBowPres, kGain\n    \n    outs aBar, aBar\nendin\n\ninstr 4\n    ; Different strike positions\n    kAmp madsr 0.1, 0.05, 0.8, 0.2\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Strike position from score\n    kPos = p5\n    kBowPres = 0.45\n    kGain = 0.95\n    \n    aBar wgbowedbar kAmp*0.4, kFreq, kPos, kBowPres, kGain\n    \n    outs aBar, aBar\nendin\n\ninstr 5\n    ; Metallic bell-like sound\n    kAmp madsr 0.02, 0.01, 0.9, 0.4\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    kPos = 0.1      ; Edge strike\n    kBowPres = 0.3  ; Light pressure\n    kGain = 0.99    ; Maximum sustain\n    \n    aBar wgbowedbar kAmp*0.3, kFreq, kPos, kBowPres, kGain\n    \n    outs aBar, aBar\nendin\n\ninstr 6\n    ; Frequency sweep\n    kAmp madsr 0.15, 0.1, 0.7, 0.3\n    \n    iFreq1 = p4\n    iFreq2 = p5\n    \n    ; Smooth frequency glide\n    kFreq expseg iFreq1, p3, iFreq2\n    \n    kPos = 0.2\n    kBowPres = 0.5\n    kGain = 0.94\n    \n    aBar wgbowedbar kAmp*0.4, kFreq, kPos, kBowPres, kGain\n    \n    outs aBar, aBar\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play basic bowed bar\ni1 0 3 440\ni1 3.5 3 523\n\n; Play vibraphone-like\ni2 7.5 4 660\ni2 9 4 523\ni2 10.5 4 440\n\n; Play dynamic bow pressure\ni3 15.5 4 330\n\n; Play different strike positions\n; Format: start dur freq position\ni4 20.5 2 392 0.1\ni4 22.5 2 392 0.3\ni4 24.5 2 392 0.5\n\n; Play metallic bell\ni5 27.5 4 880\n\n; Play frequency sweep\n; Format: start dur freq1 freq2\ni6 32.5 3 220 440\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates advanced bowed string ensemble techniques", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function table\ngiSine ftgen 1, 0, 8192, 10, 1\n\ninstr 1\n    ; String quartet simulation\n    kAmp madsr 0.3, 0.2, 0.6, 0.4\n    \n    ; Four voices with slightly detuned frequencies\n    iFreq = p4\n    kFreq1 = iFreq * 0.998     ; Slightly flat\n    kFreq2 = iFreq             ; On pitch\n    kFreq3 = iFreq * 1.002     ; Slightly sharp\n    kFreq4 = iFreq * 1.004     ; More sharp\n    \n    ; Different bow positions and pressures for each voice\n    kPres1 = 0.38\n    kPres2 = 0.42\n    kPres3 = 0.40\n    kPres4 = 0.44\n    \n    ; Different vibrato for each voice\n    kVibF1 = 5.2\n    kVibF2 = 5.8\n    kVibF3 = 6.1\n    kVibF4 = 5.5\n    \n    kVibAmp1 = 0.006\n    kVibAmp2 = 0.007\n    kVibAmp3 = 0.005\n    kVibAmp4 = 0.008\n    \n    ; Generate four string voices\n    aStr1 wgbow kAmp*0.3, kFreq1, kPres1, 0.15, kVibF1, kVibAmp1, giSine\n    aStr2 wgbow kAmp*0.3, kFreq2, kPres2, 0.18, kVibF2, kVibAmp2, giSine\n    aStr3 wgbow kAmp*0.3, kFreq3, kPres3, 0.20, kVibF3, kVibAmp3, giSine\n    aStr4 wgbow kAmp*0.3, kFreq4, kPres4, 0.16, kVibF4, kVibAmp4, giSine\n    \n    ; Stereo mix\n    aLeft = aStr1*0.8 + aStr2*0.4 + aStr3*0.5 + aStr4*0.2\n    aRight = aStr1*0.2 + aStr2*0.5 + aStr3*0.4 + aStr4*0.8\n    \n    outs aLeft, aRight\nendin\n\ninstr 2\n    ; Tremolo bowing\n    kAmp madsr 0.2, 0.1, 0.7, 0.3\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Rapid bow pressure modulation for tremolo\n    kTrem oscili 0.3, 12, giSine\n    kPres = 0.4 + kTrem\n    \n    kRat = 0.18\n    kVibF = 5\n    kVibAmp = 0.005\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 3\n    ; Col legno (hitting with wood of bow)\n    ; Using wgbowedbar for percussive quality\n    kAmp linseg 1, 0.01, 0.5, p3-0.01, 0\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Short, percussive parameters\n    kPos = 0.3\n    kBowPres = 0.8  ; High pressure for attack\n    kGain = 0.7     ; Lower sustain\n    \n    aBar wgbowedbar kAmp*0.5, kFreq, kPos, kBowPres, kGain\n    \n    outs aBar, aBar\nendin\n\ninstr 4\n    ; Spiccato (bouncing bow)\n    kAmp linseg 0, 0.001, 0.6, 0.05, 0.3, p3-0.051, 0\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Varying pressure for bounce effect\n    kPres linseg 0.6, 0.02, 0.2, 0.05, 0.5, p3-0.07, 0.1\n    \n    kRat = 0.2\n    kVibF = 0       ; No vibrato\n    kVibAmp = 0\n    \n    aBow wgbow kAmp*0.6, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 5\n    ; Sul tasto (bowing over fingerboard)\n    kAmp madsr 0.3, 0.2, 0.6, 0.4\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Low pressure and position near nut\n    kPres = 0.3\n    kRat = 0.05     ; Very close to nut\n    \n    kVibF = 5\n    kVibAmp = 0.008\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    ; Filter for darker tone\n    aBow tone aBow, 2000\n    \n    outs aBow, aBow\nendin\n\ninstr 6\n    ; Harmonic (natural overtone)\n    kAmp madsr 0.15, 0.1, 0.7, 0.3\n    \n    ; Fundamental frequency\n    iFreq = p4\n    \n    ; Harmonic number from score (2, 3, 4, etc.)\n    iHarm = p5\n    kFreq = iFreq * iHarm\n    \n    ; Light pressure for harmonic\n    kPres = 0.25\n    kRat = 1 / iHarm  ; Bow position at node\n    \n    kVibF = 5\n    kVibAmp = 0.003   ; Minimal vibrato\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 7\n    ; Crescendo/Decrescendo with bow pressure\n    iType = p5  ; 1 = crescendo, 2 = decrescendo\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    if iType == 1 then\n        ; Crescendo\n        kAmp linseg 0.1, p3, 0.7\n        kPres linseg 0.25, p3, 0.55\n    else\n        ; Decrescendo\n        kAmp linseg 0.7, p3, 0.1\n        kPres linseg 0.55, p3, 0.25\n    endif\n    \n    kRat = 0.18\n    kVibF = 5.5\n    kVibAmp = 0.007\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 8\n    ; Bowed cymbal/gong effect\n    kAmp madsr 0.05, 0.1, 0.8, 0.5\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Multiple bars for complex spectrum\n    kPos1 = 0.1\n    kPos2 = 0.23\n    kPos3 = 0.37\n    \n    kBowPres = 0.6\n    kGain = 0.98\n    \n    aBar1 wgbowedbar kAmp*0.25, kFreq, kPos1, kBowPres, kGain\n    aBar2 wgbowedbar kAmp*0.25, kFreq*1.618, kPos2, kBowPres, kGain\n    aBar3 wgbowedbar kAmp*0.25, kFreq*2.3, kPos3, kBowPres, kGain\n    \n    aMix = aBar1 + aBar2 + aBar3\n    \n    ; Add reverb for shimmer\n    aRvbL, aRvbR freeverb aMix, aMix, 0.9, 0.7\n    \n    outs aRvbL*0.6, aRvbR*0.6\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play string quartet\ni1 0 4 330\n\n; Play tremolo\ni2 5 3 440\n\n; Play col legno\ni3 9 0.5 330\ni3 9.5 0.5 440\ni3 10 0.5 523\n\n; Play spiccato\ni4 11.5 0.3 440\ni4 12 0.3 523\ni4 12.5 0.3 660\ni4 13 0.3 523\n\n; Play sul tasto\ni5 14.5 3 330\n\n; Play harmonics\n; Format: start dur fundamental harmonic_number\ni6 18.5 2 220 2    ; Octave harmonic\ni6 20.5 2 220 3    ; Fifth harmonic\ni6 22.5 2 220 4    ; Double octave\n\n; Play crescendo/decrescendo\n; Format: start dur freq type (1=cresc, 2=decresc)\ni7 26 3 392 1      ; Crescendo\ni7 29.5 3 392 2    ; Decrescendo\n\n; Play bowed cymbal\ni8 34 6 110\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates realistic cello performance techniques", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function table\ngiSine ftgen 1, 0, 8192, 10, 1\n\ninstr 1\n    ; Expressive cello phrase with dynamics\n    kAmp madsr 0.4, 0.2, 0.65, 0.5\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Expression through bow pressure\n    kPres linseg 0.35, p3*0.2, 0.5, p3*0.5, 0.45, p3*0.3, 0.3\n    \n    ; Cello typically bows around 0.1-0.2 position\n    kRat = 0.12\n    \n    ; Natural vibrato\n    kVibF = 5.5\n    kVibAmp linseg 0, p3*0.15, 0.008, p3*0.7, 0.01, p3*0.15, 0.006\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    ; Body resonance (cello formants around 250Hz and 600Hz)\n    aRes1 reson aBow, 250, 50, 1\n    aRes2 reson aBow, 600, 80, 1\n    \n    aMix = aBow*0.7 + aRes1*0.15 + aRes2*0.15\n    \n    outs aMix, aMix\nendin\n\ninstr 2\n    ; Double stops (two strings at once)\n    kAmp madsr 0.3, 0.2, 0.6, 0.4\n    \n    ; Two pitches from score\n    iFreq1 = p4\n    iFreq2 = p5\n    \n    kFreq1 = iFreq1\n    kFreq2 = iFreq2\n    \n    kPres = 0.45\n    kRat = 0.15\n    kVibF = 5.8\n    kVibAmp = 0.007\n    \n    ; Two strings with slightly different parameters\n    aStr1 wgbow kAmp*0.35, kFreq1, kPres, 0.12, kVibF, kVibAmp, giSine\n    aStr2 wgbow kAmp*0.35, kFreq2, kPres*0.95, 0.18, kVibF*1.05, kVibAmp*0.95, giSine\n    \n    aMix = aStr1 + aStr2\n    \n    outs aMix, aMix\nendin\n\ninstr 3\n    ; Pizzicato (plucked)\n    kAmp linseg 0, 0.001, 0.5, p3-0.001, 0\n    \n    iFreq = p4\n    \n    ; Use pluck for pizzicato\n    aPluck pluck kAmp, iFreq, iFreq, 0, 1\n    \n    ; Cello body resonance\n    aRes reson aPluck, 250, 40, 1\n    \n    aMix = aPluck*0.7 + aRes*0.3\n    \n    outs aMix, aMix\nendin\n\ninstr 4\n    ; Glissando between notes\n    kAmp madsr 0.3, 0.2, 0.6, 0.4\n    \n    iStart = p4\n    iEnd = p5\n    \n    ; Exponential glide for natural pitch change\n    kFreq expseg iStart, p3, iEnd\n    \n    kPres = 0.42\n    kRat = 0.15\n    kVibF = 5.5\n    kVibAmp = 0.008\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 5\n    ; Marcato (strong accent)\n    kAmp linseg 0, 0.001, 0.8, 0.05, 0.4, p3-0.051, 0.2\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Strong initial pressure\n    kPres linseg 0.7, 0.05, 0.4, p3-0.05, 0.35\n    \n    kRat = 0.13\n    kVibF = 5.5\n    kVibAmp = 0.007\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 6\n    ; Sustained low drone\n    kAmp madsr 0.5, 0.3, 0.7, 0.6\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Steady bow with subtle variations\n    kPres = 0.4 + oscili(0.02, 0.3, giSine)\n    \n    kRat = 0.1\n    \n    ; Slow, deep vibrato\n    kVibF = 4.5\n    kVibAmp = 0.012\n    \n    aBow wgbow kAmp*0.45, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    ; Emphasize low frequencies\n    aLP tone aBow, 1500\n    \n    outs aLP, aLP\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play expressive phrase\ni1 0 3 220\ni1 3.5 3 247\ni1 7 4 196\n\n; Play double stops\n; Format: start dur freq1 freq2\ni2 12 3 196 294   ; Fifth interval\ni2 15.5 3 220 330 ; Fifth interval\n\n; Play pizzicato\ni3 20 1 220\ni3 21 1 247\ni3 22 1 294\ni3 23 1 330\n\n; Play glissando\n; Format: start dur start_freq end_freq\ni4 25 2 147 220\ni4 27.5 2 220 330\n\n; Play marcato\ni5 31 1.5 196\ni5 32.5 1.5 220\ni5 34 1.5 247\n\n; Play sustained drone\ni6 37 6 98\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates violin and viola ensemble with advanced playing techniques", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function table\ngiSine ftgen 1, 0, 8192, 10, 1\n\ninstr 1\n    ; Violin (high register)\n    kAmp madsr 0.25, 0.15, 0.65, 0.35\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Violin bow parameters\n    kPres = 0.38\n    kRat = 0.08     ; Closer to nut for violin\n    \n    ; Fast, delicate vibrato\n    kVibF = 6.5\n    kVibAmp = 0.009\n    \n    aBow wgbow kAmp*0.45, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    ; Violin body resonances (around 500Hz and 1200Hz)\n    aRes1 reson aBow, 500, 60, 1\n    aRes2 reson aBow, 1200, 100, 1\n    \n    aMix = aBow*0.65 + aRes1*0.15 + aRes2*0.2\n    \n    outs aMix, aMix\nendin\n\ninstr 2\n    ; Viola (middle register)\n    kAmp madsr 0.3, 0.2, 0.65, 0.4\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Viola bow parameters\n    kPres = 0.42\n    kRat = 0.11\n    \n    ; Medium vibrato\n    kVibF = 5.8\n    kVibAmp = 0.008\n    \n    aBow wgbow kAmp*0.48, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    ; Viola body resonances (lower than violin)\n    aRes1 reson aBow, 350, 50, 1\n    aRes2 reson aBow, 800, 80, 1\n    \n    aMix = aBow*0.65 + aRes1*0.18 + aRes2*0.17\n    \n    outs aMix, aMix\nendin\n\ninstr 3\n    ; Ricochet (bouncing bow)\n    kNote = 0\n    kBounce = 0\n    \n    iFreq = p4\n    iBounces = 6    ; Number of bounces\n    iBounceRate = 12 ; Hz\n    \n    ; Generate bounces\n    kMetro metro iBounceRate\n    \n    if kMetro == 1 then\n        kBounce = kBounce + 1\n    endif\n    \n    ; Amplitude envelope per bounce\n    kAmp linseg 0.6, p3/iBounces, 0.2\n    kAmp = kAmp * (1 - linseg(0, 0.05, 1, 0.01, 1))\n    \n    kFreq = iFreq\n    kPres = 0.5\n    kRat = 0.1\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, 0, 0, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 4\n    ; Detache (separate bow strokes)\n    kAmp linseg 0, 0.005, 0.5, p3-0.105, 0.5, 0.1, 0\n    \n    iFreq = p4\n    kFreq = iFreq\n    \n    ; Clear attack and separation\n    kPres linseg 0.5, 0.01, 0.4, p3-0.11, 0.4, 0.1, 0.2\n    \n    kRat = 0.12\n    kVibF = 6\n    kVibAmp = 0.006\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 5\n    ; String crossing with legato\n    kAmp madsr 0.2, 0.1, 0.7, 0.3\n    \n    ; Cross between two notes\n    iFreq1 = p4\n    iFreq2 = p5\n    \n    ; Smooth transition\n    kFreq linseg iFreq1, p3*0.4, iFreq1, p3*0.2, iFreq2, p3*0.4, iFreq2\n    \n    kPres = 0.42\n    kRat = 0.1\n    kVibF = 6.2\n    kVibAmp = 0.007\n    \n    aBow wgbow kAmp*0.5, kFreq, kPres, kRat, kVibF, kVibAmp, giSine\n    \n    outs aBow, aBow\nendin\n\ninstr 6\n    ; Harmonics with shimmer\n    kAmp madsr 0.15, 0.1, 0.75, 0.4\n    \n    ; Fundamental and harmonic\n    iFund = p4\n    iHarm = p5      ; Harmonic number\n    \n    kFreq1 = iFund * iHarm\n    kFreq2 = iFund * (iHarm + 1)\n    \n    ; Two harmonics for shimmer\n    kPres1 = 0.25\n    kPres2 = 0.22\n    \n    kRat1 = 1 / iHarm\n    kRat2 = 1 / (iHarm + 1)\n    \n    aHarm1 wgbow kAmp*0.35, kFreq1, kPres1, kRat1, 5, 0.003, giSine\n    aHarm2 wgbow kAmp*0.35, kFreq2, kPres2, kRat2, 5.3, 0.003, giSine\n    \n    aMix = aHarm1 + aHarm2\n    \n    outs aMix, aMix\nendin\n\ninstr 7\n    ; String orchestra chord\n    kAmp madsr 0.4, 0.3, 0.65, 0.5\n    \n    ; Root, third, fifth, octave\n    iRoot = p4\n    i3rd = iRoot * 5/4   ; Major third\n    i5th = iRoot * 3/2   ; Fifth\n    i8ve = iRoot * 2     ; Octave\n    \n    ; Four voices with slight detuning\n    kFreq1 = iRoot * 0.999\n    kFreq2 = i3rd * 1.001\n    kFreq3 = i5th * 0.998\n    kFreq4 = i8ve * 1.002\n    \n    kPres = 0.42\n    kVibF = 5.5\n    kVibAmp = 0.007\n    \n    ; Generate voices\n    aVoice1 wgbow kAmp*0.25, kFreq1, kPres, 0.12, kVibF, kVibAmp, giSine\n    aVoice2 wgbow kAmp*0.25, kFreq2, kPres, 0.14, kVibF*1.05, kVibAmp*0.95, giSine\n    aVoice3 wgbow kAmp*0.25, kFreq3, kPres, 0.16, kVibF*0.95, kVibAmp*1.05, giSine\n    aVoice4 wgbow kAmp*0.25, kFreq4, kPres, 0.11, kVibF*1.03, kVibAmp, giSine\n    \n    ; Stereo spread\n    aLeft = aVoice1*0.8 + aVoice2*0.5 + aVoice3*0.4 + aVoice4*0.2\n    aRight = aVoice1*0.2 + aVoice2*0.4 + aVoice3*0.5 + aVoice4*0.8\n    \n    outs aLeft, aRight\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play violin melody\ni1 0 2 880\ni1 2 2 988\ni1 4 3 784\n\n; Play viola harmony\ni2 0.5 2 440\ni2 2.5 2 494\ni2 4.5 3 392\n\n; Play ricochet\ni3 8.5 0.5 1046\n\n; Play detache articulation\ni4 10 0.8 659\ni4 10.9 0.8 784\ni4 11.8 0.8 880\n\n; Play string crossing\n; Format: start dur freq1 freq2\ni5 13.5 2 440 659\ni5 15.5 2 523 784\n\n; Play harmonics with shimmer\n; Format: start dur fundamental harmonic_number\ni6 18.5 3 220 3\ni6 21.5 3 220 4\n\n; Play string orchestra chord\ni7 26 5 264  ; C major chord\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
