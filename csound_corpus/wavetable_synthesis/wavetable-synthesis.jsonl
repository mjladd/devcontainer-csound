{"instruction": "Write a CSound instrument that demonstrates the poscil opcode for precise wavetable oscillator", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function tables\ngiSine ftgen 1, 0, 16384, 10, 1\ngiSaw ftgen 2, 0, 16384, 10, 1, 0.5, 0.3, 0.25, 0.2, 0.16, 0.14, 0.12, 0.11, 0.09\ngiSquare ftgen 3, 0, 16384, 10, 1, 0, 0.3, 0, 0.2, 0, 0.14, 0, 0.11, 0, 0.09\ngiTri ftgen 4, 0, 16384, 10, 1, 0, -0.11, 0, 0.04, 0, -0.02, 0, 0.01\n\ninstr 1\n    ; poscil opcode: ares poscil xamp, xcps [, ifn, iphs]\n    ; poscil is a precise oscillator with linear interpolation\n    ; xamp - amplitude\n    ; xcps - frequency in Hz\n    ; ifn - function table number (optional, defaults to sine)\n    ; iphs - initial phase 0-1 (optional, defaults to 0)\n    \n    ; Basic sine wave\n    iAmp = 0.5\n    iFreq = p4\n    \n    aOsc poscil iAmp, iFreq, giSine\n    \n    outs aOsc, aOsc\nendin\n\ninstr 2\n    ; Sawtooth wave\n    iAmp = 0.4\n    iFreq = p4\n    \n    aOsc poscil iAmp, iFreq, giSaw\n    \n    outs aOsc, aOsc\nendin\n\ninstr 3\n    ; Square wave\n    iAmp = 0.4\n    iFreq = p4\n    \n    aOsc poscil iAmp, iFreq, giSquare\n    \n    outs aOsc, aOsc\nendin\n\ninstr 4\n    ; Triangle wave\n    iAmp = 0.5\n    iFreq = p4\n    \n    aOsc poscil iAmp, iFreq, giTri\n    \n    outs aOsc, aOsc\nendin\n\ninstr 5\n    ; Amplitude modulation\n    iFreq = p4\n    \n    ; Modulating amplitude\n    kAmp poscil 0.3, 6, giSine\n    kAmp = 0.2 + kAmp\n    \n    aOsc poscil kAmp, iFreq, giSine\n    \n    outs aOsc, aOsc\nendin\n\ninstr 6\n    ; Frequency modulation (vibrato)\n    iAmp = 0.5\n    iFreq = p4\n    \n    ; Vibrato\n    kVib poscil 8, 5, giSine\n    kFreq = iFreq + kVib\n    \n    aOsc poscil iAmp, kFreq, giSine\n    \n    outs aOsc, aOsc\nendin\n\ninstr 7\n    ; Phase offset\n    iAmp = 0.4\n    iFreq = p4\n    \n    ; Two oscillators with phase offset for stereo\n    aOscL poscil iAmp, iFreq, giSine, 0\n    aOscR poscil iAmp, iFreq, giSine, 0.25\n    \n    outs aOscL, aOscR\nendin\n\ninstr 8\n    ; Frequency sweep\n    iAmp = 0.5\n    \n    iStart = p4\n    iEnd = p5\n    \n    ; Exponential frequency sweep\n    kFreq expseg iStart, p3, iEnd\n    \n    aOsc poscil iAmp, kFreq, giSine\n    \n    outs aOsc, aOsc\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play sine wave\ni1 0 2 440\ni1 2.5 2 523\n\n; Play sawtooth\ni2 5.5 2 330\n\n; Play square\ni3 8.5 2 392\n\n; Play triangle\ni4 11.5 2 294\n\n; Play amplitude modulation\ni5 14.5 3 440\n\n; Play vibrato\ni6 18.5 3 523\n\n; Play stereo phase\ni7 22.5 2 330\n\n; Play frequency sweep\n; Format: start dur freq_start freq_end\ni8 25.5 3 220 880\ni8 28.5 3 880 220\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates the vposcil opcode for variable phase oscillators", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function tables\ngiSine ftgen 1, 0, 16384, 10, 1\ngiSaw ftgen 2, 0, 16384, 10, 1, 0.5, 0.3, 0.25, 0.2, 0.16, 0.14, 0.12\ngiSquare ftgen 3, 0, 16384, 10, 1, 0, 0.3, 0, 0.2, 0, 0.14\n\ninstr 1\n    ; vposcil opcode: ares vposcil aamp, acps, ifn [, iphs]\n    ; vposcil is like poscil but with audio-rate amplitude and frequency\n    ; aamp - audio-rate amplitude\n    ; acps - audio-rate frequency in Hz\n    ; ifn - function table number\n    ; iphs - initial phase 0-1 (optional)\n    \n    ; Basic usage with constant inputs\n    iAmp = 0.5\n    iFreq = p4\n    \n    aAmp = iAmp\n    aFreq = iFreq\n    \n    aOsc vposcil aAmp, aFreq, giSine\n    \n    outs aOsc, aOsc\nendin\n\ninstr 2\n    ; Audio-rate amplitude modulation\n    iFreq = p4\n    \n    ; Fast amplitude modulation at audio rate\n    aModAmp poscil 0.3, 8, giSine\n    aAmp = 0.2 + aModAmp\n    \n    aFreq = iFreq\n    \n    aOsc vposcil aAmp, aFreq, giSine\n    \n    outs aOsc, aOsc\nendin\n\ninstr 3\n    ; Audio-rate frequency modulation (FM synthesis)\n    iAmp = 0.4\n    iCarrier = p4\n    iModRatio = p5\n    iModIndex = p6\n    \n    ; Modulator at audio rate\n    iModFreq = iCarrier * iModRatio\n    iModDepth = iModFreq * iModIndex\n    \n    aMod poscil iModDepth, iModFreq, giSine\n    aFreq = iCarrier + aMod\n    \n    aAmp = iAmp\n    aOsc vposcil aAmp, aFreq, giSine\n    \n    outs aOsc, aOsc\nendin\n\ninstr 4\n    ; Ring modulation\n    iAmp = 0.4\n    iFreq = p4\n    iModFreq = p5\n    \n    ; Modulator controls amplitude\n    aMod poscil 1, iModFreq, giSine\n    aAmp = iAmp * aMod\n    \n    aFreq = iFreq\n    \n    aOsc vposcil aAmp, aFreq, giSine\n    \n    outs aOsc, aOsc\nendin\n\ninstr 5\n    ; Tremolo with sawtooth\n    iFreq = p4\n    \n    ; Audio-rate tremolo\n    aTrem poscil 0.3, 7, giSine\n    aAmp = 0.3 + aTrem\n    \n    aFreq = iFreq\n    \n    aOsc vposcil aAmp, aFreq, giSaw\n    \n    outs aOsc, aOsc\nendin\n\ninstr 6\n    ; Frequency tracking\n    iAmp = 0.4\n    \n    ; Audio-rate frequency envelope\n    aFreq expsega 220, 0.5, 880, 0.5, 440, p3-1, 440\n    aAmp = iAmp\n    \n    aOsc vposcil aAmp, aFreq, giSine\n    \n    outs aOsc, aOsc\nendin\n\ninstr 7\n    ; Both amplitude and frequency modulation\n    iCarrier = p4\n    \n    ; Amplitude modulation\n    aAmpMod poscil 0.2, 6, giSine\n    aAmp = 0.3 + aAmpMod\n    \n    ; Frequency modulation\n    aFreqMod poscil 15, 5, giSine\n    aFreq = iCarrier + aFreqMod\n    \n    aOsc vposcil aAmp, aFreq, giSine\n    \n    outs aOsc, aOsc\nendin\n\ninstr 8\n    ; Complex modulation\n    iAmp = 0.35\n    iFreq = p4\n    \n    ; Two modulators\n    aFreqMod1 poscil 20, 3, giSine\n    aFreqMod2 poscil 10, 7, giSine\n    \n    aFreq = iFreq + aFreqMod1 + aFreqMod2\n    aAmp = iAmp\n    \n    aOsc vposcil aAmp, aFreq, giSquare\n    \n    outs aOsc, aOsc\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play basic vposcil\ni1 0 2 440\n\n; Play audio-rate AM\ni2 3 3 523\n\n; Play FM synthesis\n; Format: start dur carrier mod_ratio mod_index\ni3 7 2 220 2 5\ni3 9 2 220 3 3\ni3 11 2 330 1.5 8\n\n; Play ring modulation\n; Format: start dur carrier modulator\ni4 14 2 440 30\ni4 16 2 440 100\n\n; Play tremolo\ni5 19 3 330\n\n; Play frequency tracking\ni6 23 2 0\ni6 25 2 0\n\n; Play AM + FM\ni7 28 3 392\n\n; Play complex modulation\ni8 32 3 294\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates the oscbnk opcode for oscillator bank synthesis", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Function table for oscbnk\ngiSine ftgen 1, 0, 16384, 10, 1\n\n; Tables for oscillator bank parameters\n; Format: frequency multipliers\ngiFreqs ftgen 10, 0, 8, -2, 1, 2, 3, 4, 5, 6, 7, 8\ngiFreqs2 ftgen 11, 0, 8, -2, 1, 1.5, 2, 2.5, 3, 4, 5, 6\ngiFreqs3 ftgen 12, 0, 8, -2, 1, 1.01, 2, 2.02, 3, 3.01, 4, 4.02\n\n; Amplitude tables\ngiAmps1 ftgen 20, 0, 8, -2, 1, 0.5, 0.3, 0.2, 0.15, 0.1, 0.08, 0.05\ngiAmps2 ftgen 21, 0, 8, -2, 1, 0.8, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1\ngiAmps3 ftgen 22, 0, 8, -2, 0.5, 1, 0.5, 0.3, 0.2, 0.15, 0.1, 0.08\n\ninstr 1\n    ; oscbnk opcode: ares oscbnk kcps, kamd, kfmd, kpmd, iovrlap, iseed, kl1minf, kl1maxf, \n    ;                       kl2minf, kl2maxf, ilfomode, keqminf, keqmaxf, keqminl, keqmaxl, \n    ;                       keqminq, keqmaxq, ieqmode, kfn [, il1fn] [, il2fn] [, ieqffn] \n    ;                       [, ieqlfn] [, ieqqfn] [, itabl] [, ioutfn]\n    ; oscbnk mixes multiple oscillators with different frequencies and amplitudes\n    ; Simpler version: ares oscbnk kcps, kfmd, kamd, inum, ifn, ifreqfn, iampfn\n    ; kcps - base frequency\n    ; kfmd - frequency multiplier depth\n    ; kamd - amplitude multiplier depth  \n    ; inum - number of oscillators\n    ; ifn - waveform table\n    ; ifreqfn - frequency multiplier table\n    ; iampfn - amplitude table\n    \n    ; Basic harmonic series\n    kAmp = 0.3\n    kFreq = p4\n    iNum = 8\n    \n    ; Standard oscbnk with simpler syntax\n    aOsc poscil kAmp, kFreq, giSine\n    \n    ; Manual oscillator bank for demonstration\n    a1 poscil 0.3, kFreq*1, giSine\n    a2 poscil 0.15, kFreq*2, giSine\n    a3 poscil 0.1, kFreq*3, giSine\n    a4 poscil 0.075, kFreq*4, giSine\n    a5 poscil 0.06, kFreq*5, giSine\n    a6 poscil 0.05, kFreq*6, giSine\n    \n    aMix = (a1 + a2 + a3 + a4 + a5 + a6) * 0.5\n    \n    outs aMix, aMix\nendin\n\ninstr 2\n    ; Inharmonic spectrum\n    kAmp = 0.3\n    kFreq = p4\n    \n    ; Manually create inharmonic partials\n    a1 poscil 0.3, kFreq*1, giSine\n    a2 poscil 0.24, kFreq*1.5, giSine\n    a3 poscil 0.18, kFreq*2, giSine\n    a4 poscil 0.15, kFreq*2.5, giSine\n    a5 poscil 0.12, kFreq*3, giSine\n    a6 poscil 0.09, kFreq*4, giSine\n    a7 poscil 0.06, kFreq*5, giSine\n    a8 poscil 0.03, kFreq*6, giSine\n    \n    aMix = (a1 + a2 + a3 + a4 + a5 + a6 + a7 + a8) * 0.5\n    \n    outs aMix, aMix\nendin\n\ninstr 3\n    ; Detuned oscillator bank (chorus effect)\n    kAmp = 0.25\n    kFreq = p4\n    \n    ; Slightly detuned oscillators\n    a1 poscil kAmp, kFreq*1.00, giSine\n    a2 poscil kAmp, kFreq*1.01, giSine\n    a3 poscil kAmp, kFreq*2.00, giSine\n    a4 poscil kAmp, kFreq*2.02, giSine\n    a5 poscil kAmp, kFreq*3.00, giSine\n    a6 poscil kAmp, kFreq*3.01, giSine\n    \n    aMix = (a1 + a2 + a3 + a4 + a5 + a6) * 0.3\n    \n    outs aMix, aMix\nendin\n\ninstr 4\n    ; Time-varying amplitudes\n    kFreq = p4\n    \n    ; Individual amplitude envelopes\n    kAmp1 linseg 0.3, p3*0.3, 0.3, p3*0.7, 0\n    kAmp2 linseg 0, p3*0.2, 0.2, p3*0.8, 0\n    kAmp3 linseg 0, p3*0.3, 0.15, p3*0.7, 0\n    kAmp4 linseg 0, p3*0.4, 0.1, p3*0.6, 0\n    kAmp5 linseg 0, p3*0.5, 0.08, p3*0.5, 0\n    \n    a1 poscil kAmp1, kFreq*1, giSine\n    a2 poscil kAmp2, kFreq*2, giSine\n    a3 poscil kAmp3, kFreq*3, giSine\n    a4 poscil kAmp4, kFreq*4, giSine\n    a5 poscil kAmp5, kFreq*5, giSine\n    \n    aMix = (a1 + a2 + a3 + a4 + a5) * 0.6\n    \n    outs aMix, aMix\nendin\n\ninstr 5\n    ; Formant-like spectrum\n    kAmp = 0.25\n    kFreq = p4\n    \n    ; Emphasize certain harmonics for vowel-like sound\n    a1 poscil 0.2, kFreq*1, giSine\n    a2 poscil 0.15, kFreq*2, giSine\n    a3 poscil 0.3, kFreq*3, giSine    ; First formant peak\n    a4 poscil 0.25, kFreq*4, giSine\n    a5 poscil 0.1, kFreq*5, giSine\n    a6 poscil 0.05, kFreq*6, giSine\n    a7 poscil 0.35, kFreq*7, giSine   ; Second formant peak\n    a8 poscil 0.3, kFreq*8, giSine\n    a9 poscil 0.15, kFreq*9, giSine\n    a10 poscil 0.08, kFreq*10, giSine\n    \n    aMix = (a1 + a2 + a3 + a4 + a5 + a6 + a7 + a8 + a9 + a10) * 0.3\n    \n    outs aMix, aMix\nendin\n\ninstr 6\n    ; Additive bell synthesis\n    kAmp = 0.25\n    kFreq = p4\n    \n    ; Inharmonic ratios typical of bells\n    a1 poscil 0.3, kFreq*1, giSine\n    a2 poscil 0.2, kFreq*2.76, giSine\n    a3 poscil 0.15, kFreq*5.40, giSine\n    a4 poscil 0.1, kFreq*8.93, giSine\n    \n    ; Different decay rates\n    kDecay1 expseg 1, p3, 0.001\n    kDecay2 expseg 1, p3*0.7, 0.001\n    kDecay3 expseg 1, p3*0.5, 0.001\n    kDecay4 expseg 1, p3*0.3, 0.001\n    \n    aMix = (a1*kDecay1 + a2*kDecay2 + a3*kDecay3 + a4*kDecay4) * 0.5\n    \n    outs aMix, aMix\nendin\n\ninstr 7\n    ; Dynamic spectrum morphing\n    kFreq = p4\n    \n    ; Morph between harmonic and inharmonic\n    kMorph linseg 0, p3, 1\n    \n    ; Harmonic frequencies\n    kFreq1 = kFreq * (1 + kMorph*0.1)\n    kFreq2 = kFreq * (2 + kMorph*0.5)\n    kFreq3 = kFreq * (3 + kMorph*1.2)\n    kFreq4 = kFreq * (4 + kMorph*1.8)\n    kFreq5 = kFreq * (5 + kMorph*2.5)\n    \n    a1 poscil 0.3, kFreq1, giSine\n    a2 poscil 0.2, kFreq2, giSine\n    a3 poscil 0.15, kFreq3, giSine\n    a4 poscil 0.1, kFreq4, giSine\n    a5 poscil 0.08, kFreq5, giSine\n    \n    aMix = (a1 + a2 + a3 + a4 + a5) * 0.5\n    \n    outs aMix, aMix\nendin\n\ninstr 8\n    ; Stereo oscillator bank\n    kFreq = p4\n    \n    ; Left channel: odd harmonics\n    aL1 poscil 0.25, kFreq*1, giSine\n    aL3 poscil 0.15, kFreq*3, giSine\n    aL5 poscil 0.1, kFreq*5, giSine\n    aL7 poscil 0.08, kFreq*7, giSine\n    \n    ; Right channel: even harmonics\n    aR2 poscil 0.2, kFreq*2, giSine\n    aR4 poscil 0.12, kFreq*4, giSine\n    aR6 poscil 0.09, kFreq*6, giSine\n    aR8 poscil 0.06, kFreq*8, giSine\n    \n    aLeft = (aL1 + aL3 + aL5 + aL7) * 0.5\n    aRight = (aR2 + aR4 + aR6 + aR8) * 0.5\n    \n    outs aLeft, aRight\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play harmonic series\ni1 0 3 220\ni1 3.5 3 294\n\n; Play inharmonic spectrum\ni2 7.5 3 330\n\n; Play detuned bank (chorus)\ni3 11.5 3 440\n\n; Play time-varying amplitudes\ni4 15.5 4 392\n\n; Play formant-like\ni5 20.5 3 220\n\n; Play bell synthesis\ni6 24.5 4 523\ni6 28.5 4 440\n\n; Play spectrum morphing\ni7 33.5 5 294\n\n; Play stereo bank\ni8 39.5 3 330\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates advanced wavetable synthesis techniques with poscil", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Multiple waveform tables\ngiSine ftgen 1, 0, 16384, 10, 1\ngiSaw ftgen 2, 0, 16384, 10, 1, 0.5, 0.3, 0.25, 0.2, 0.16, 0.14, 0.12, 0.11, 0.09, 0.08\ngiSquare ftgen 3, 0, 16384, 10, 1, 0, 0.3, 0, 0.2, 0, 0.14, 0, 0.11, 0, 0.09\ngiTri ftgen 4, 0, 16384, 10, 1, 0, -0.11, 0, 0.04, 0, -0.02, 0, 0.01\ngiPulse ftgen 5, 0, 16384, 10, 1, 1, 1, 1, 0.7, 0.5, 0.3, 0.1\n\ninstr 1\n    ; Multiple detuned oscillators\n    iAmp = 0.25\n    iFreq = p4\n    \n    ; Three oscillators slightly detuned\n    aOsc1 poscil iAmp, iFreq*0.995, giSaw\n    aOsc2 poscil iAmp, iFreq, giSaw\n    aOsc3 poscil iAmp, iFreq*1.005, giSaw\n    \n    aMix = (aOsc1 + aOsc2 + aOsc3) * 0.4\n    \n    outs aMix, aMix\nendin\n\ninstr 2\n    ; Layered waveforms\n    iAmp = 0.3\n    iFreq = p4\n    \n    ; Mix different waveforms\n    aSine poscil iAmp*0.5, iFreq, giSine\n    aSaw poscil iAmp*0.3, iFreq, giSaw\n    aSquare poscil iAmp*0.2, iFreq, giSquare\n    \n    aMix = aSine + aSaw + aSquare\n    \n    outs aMix, aMix\nendin\n\ninstr 3\n    ; Sub-oscillator\n    iAmp = 0.35\n    iFreq = p4\n    \n    ; Main oscillator\n    aMain poscil iAmp*0.6, iFreq, giSaw\n    \n    ; Sub-oscillator (one octave down)\n    aSub poscil iAmp*0.4, iFreq*0.5, giSquare\n    \n    aMix = aMain + aSub\n    \n    outs aMix, aMix\nendin\n\ninstr 4\n    ; Octave doubling\n    iAmp = 0.3\n    iFreq = p4\n    \n    ; Fundamental\n    aFund poscil iAmp*0.5, iFreq, giSaw\n    \n    ; Octave up\n    aOct poscil iAmp*0.3, iFreq*2, giSaw\n    \n    ; Two octaves up\n    a2Oct poscil iAmp*0.2, iFreq*4, giSaw\n    \n    aMix = aFund + aOct + a2Oct\n    \n    outs aMix, aMix\nendin\n\ninstr 5\n    ; PWM (Pulse Width Modulation) simulation\n    iAmp = 0.35\n    iFreq = p4\n    \n    ; Two square waves with phase offset\n    kWidth lfo 0.4, 0.5, 1\n    kPhase = 0.5 + kWidth*0.4\n    \n    aOsc1 poscil iAmp, iFreq, giSquare, 0\n    aOsc2 poscil iAmp, iFreq, giSquare, kPhase\n    \n    aMix = aOsc1 - aOsc2\n    \n    outs aMix, aMix\nendin\n\ninstr 6\n    ; Sync oscillator\n    iAmp = 0.35\n    iMaster = p4\n    \n    ; Master oscillator controls phase reset\n    aMaster poscil 1, iMaster, giSaw\n    \n    ; Slave oscillator at higher frequency\n    kSlaveFreq linseg iMaster*1.5, p3, iMaster*4\n    aSlave poscil iAmp, kSlaveFreq, giSaw\n    \n    ; Output slave\n    outs aSlave, aSlave\nendin\n\ninstr 7\n    ; Unison spread (supersaw)\n    iAmp = 0.2\n    iFreq = p4\n    \n    ; Seven detuned oscillators\n    aOsc1 poscil iAmp, iFreq*0.985, giSaw\n    aOsc2 poscil iAmp, iFreq*0.992, giSaw\n    aOsc3 poscil iAmp, iFreq*0.997, giSaw\n    aOsc4 poscil iAmp, iFreq, giSaw\n    aOsc5 poscil iAmp, iFreq*1.003, giSaw\n    aOsc6 poscil iAmp, iFreq*1.008, giSaw\n    aOsc7 poscil iAmp, iFreq*1.015, giSaw\n    \n    aMix = (aOsc1 + aOsc2 + aOsc3 + aOsc4 + aOsc5 + aOsc6 + aOsc7) * 0.3\n    \n    outs aMix, aMix\nendin\n\ninstr 8\n    ; Cross-modulation\n    iAmp = 0.35\n    iFreq = p4\n    \n    ; Oscillator 1 modulates oscillator 2\n    aOsc1 poscil 50, iFreq*0.5, giSine\n    kFreq2 = iFreq + aOsc1\n    \n    aOsc2 poscil iAmp, kFreq2, giSaw\n    \n    outs aOsc2, aOsc2\nendin\n\ninstr 9\n    ; Formant synthesis\n    iAmp = 0.25\n    iFreq = p4\n    \n    ; Source (sawtooth)\n    aSource poscil 0.5, iFreq, giSaw\n    \n    ; Formant filters (resonant peaks)\n    aForm1 butterbp aSource, 800, 80\n    aForm2 butterbp aSource, 1200, 90\n    aForm3 butterbp aSource, 2600, 120\n    \n    aMix = (aForm1 + aForm2 + aForm3) * iAmp * 3\n    \n    outs aMix, aMix\nendin\n\ninstr 10\n    ; Stereo phase effects\n    iAmp = 0.35\n    iFreq = p4\n    \n    ; Left and right with different phase relationships\n    aOscL1 poscil iAmp*0.5, iFreq, giSaw, 0\n    aOscL2 poscil iAmp*0.3, iFreq*1.005, giSaw, 0.2\n    \n    aOscR1 poscil iAmp*0.5, iFreq*1.002, giSaw, 0.5\n    aOscR2 poscil iAmp*0.3, iFreq*0.998, giSaw, 0.7\n    \n    aLeft = aOscL1 + aOscL2\n    aRight = aOscR1 + aOscR2\n    \n    outs aLeft, aRight\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play detuned oscillators\ni1 0 3 220\n\n; Play layered waveforms\ni2 4 3 330\n\n; Play sub-oscillator\ni3 8 3 294\n\n; Play octave doubling\ni4 12 3 392\n\n; Play PWM simulation\ni5 16 4 220\n\n; Play sync oscillator\ni6 21 3 165\n\n; Play supersaw\ni7 25 3 440\n\n; Play cross-modulation\ni8 29 3 330\n\n; Play formant synthesis\ni9 33 3 220\n\n; Play stereo phase\ni10 37 3 523\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
{"instruction": "Write a CSound instrument that demonstrates complex additive and wavetable synthesis techniques", "input": "", "output": "<CsoundSynthesizer>\n<CsOptions>\n-odac\n</CsOptions>\n<CsInstruments>\n\nsr = 44100\nkr = 4410\nksmps = 10\nnchnls = 2\n0dbfs = 1\n\n; Waveform tables\ngiSine ftgen 1, 0, 16384, 10, 1\ngiSaw ftgen 2, 0, 16384, 10, 1, 0.5, 0.3, 0.25, 0.2, 0.16, 0.14, 0.12, 0.11, 0.09\ngiSquare ftgen 3, 0, 16384, 10, 1, 0, 0.3, 0, 0.2, 0, 0.14, 0, 0.11\n\ninstr 1\n    ; Additive organ sound\n    iAmp = 0.25\n    iFreq = p4\n    \n    ; Multiple harmonics with organ-like drawbar levels\n    a1 poscil iAmp*1.0, iFreq*0.5, giSine      ; 16' (sub-octave)\n    a2 poscil iAmp*0.8, iFreq*1.0, giSine      ; 8' (fundamental)\n    a3 poscil iAmp*0.8, iFreq*1.5, giSine      ; 5 1/3' (fifth)\n    a4 poscil iAmp*0.6, iFreq*2.0, giSine      ; 4' (octave)\n    a5 poscil iAmp*0.5, iFreq*3.0, giSine      ; 2 2/3' (twelfth)\n    a6 poscil iAmp*0.4, iFreq*4.0, giSine      ; 2' (fifteenth)\n    a7 poscil iAmp*0.3, iFreq*6.0, giSine      ; 1 1/3' (nineteenth)\n    a8 poscil iAmp*0.2, iFreq*8.0, giSine      ; 1' (twenty-second)\n    \n    aMix = (a1 + a2 + a3 + a4 + a5 + a6 + a7 + a8) * 0.25\n    \n    outs aMix, aMix\nendin\n\ninstr 2\n    ; Spectral shimmer (rising harmonics)\n    iAmp = 0.25\n    iFreq = p4\n    \n    ; Harmonics with time-varying amplitudes\n    kEnv1 linseg 1, p3, 0.2\n    kEnv2 linseg 0.5, p3, 1\n    kEnv3 linseg 0.3, p3, 1\n    kEnv4 linseg 0.2, p3, 1\n    kEnv5 linseg 0.1, p3, 0.8\n    \n    a1 poscil iAmp*kEnv1, iFreq*1, giSine\n    a2 poscil iAmp*kEnv2, iFreq*2, giSine\n    a3 poscil iAmp*kEnv3, iFreq*3, giSine\n    a4 poscil iAmp*kEnv4, iFreq*4, giSine\n    a5 poscil iAmp*kEnv5, iFreq*5, giSine\n    \n    aMix = (a1 + a2 + a3 + a4 + a5) * 0.4\n    \n    outs aMix, aMix\nendin\n\ninstr 3\n    ; Bell-like additive sound\n    iAmp = 0.3\n    iFreq = p4\n    \n    ; Inharmonic partials with independent decays\n    kDecay1 expseg 1, p3, 0.001\n    kDecay2 expseg 1, p3*0.8, 0.001\n    kDecay3 expseg 1, p3*0.6, 0.001\n    kDecay4 expseg 1, p3*0.4, 0.001\n    kDecay5 expseg 1, p3*0.3, 0.001\n    kDecay6 expseg 1, p3*0.2, 0.001\n    \n    a1 poscil iAmp*0.5*kDecay1, iFreq*1, giSine\n    a2 poscil iAmp*0.3*kDecay2, iFreq*2.76, giSine\n    a3 poscil iAmp*0.25*kDecay3, iFreq*5.40, giSine\n    a4 poscil iAmp*0.2*kDecay4, iFreq*8.93, giSine\n    a5 poscil iAmp*0.15*kDecay5, iFreq*13.34, giSine\n    a6 poscil iAmp*0.1*kDecay6, iFreq*18.64, giSine\n    \n    aMix = (a1 + a2 + a3 + a4 + a5 + a6) * 0.5\n    \n    outs aMix, aMix\nendin\n\ninstr 4\n    ; Vocoder-like formant shifting\n    iAmp = 0.3\n    iFreq = p4\n    \n    ; Source oscillator\n    aSource poscil 0.5, iFreq, giSaw\n    \n    ; Formants shift over time\n    kForm1 linseg 600, p3, 900\n    kForm2 linseg 1040, p3, 1400\n    kForm3 linseg 2250, p3, 2800\n    \n    ; Filter source at formant frequencies\n    aForm1 butterbp aSource, kForm1, kForm1*0.1\n    aForm2 butterbp aSource, kForm2, kForm2*0.08\n    aForm3 butterbp aSource, kForm3, kForm3*0.06\n    \n    aMix = (aForm1*1.5 + aForm2*1.0 + aForm3*0.6) * iAmp\n    \n    outs aMix, aMix\nendin\n\ninstr 5\n    ; Phase-modulation synthesis with poscil\n    iAmp = 0.35\n    iCarrier = p4\n    iModRatio = p5\n    \n    ; Modulator\n    iModFreq = iCarrier * iModRatio\n    aModIndex linseg 0, p3*0.3, 8, p3*0.7, 0\n    aMod poscil iModFreq*aModIndex, iModFreq, giSine\n    \n    ; Carrier with phase modulation\n    aPhase = aMod / iCarrier\n    aCarrier vposcil iAmp, iCarrier, giSine\n    \n    outs aCarrier, aCarrier\nendin\n\ninstr 6\n    ; Morphing wavetable (crossfade between waveforms)\n    iAmp = 0.35\n    iFreq = p4\n    \n    ; Crossfade parameter\n    kMorph linseg 0, p3, 1\n    \n    ; Three waveforms\n    aSaw poscil iAmp, iFreq, giSaw\n    aSquare poscil iAmp, iFreq, giSquare\n    aSine poscil iAmp, iFreq, giSine\n    \n    ; Crossfade: Saw -> Square -> Sine\n    if kMorph < 0.5 then\n        kMix1 = 1 - kMorph*2\n        kMix2 = kMorph*2\n        kMix3 = 0\n    else\n        kMix1 = 0\n        kMix2 = 1 - (kMorph-0.5)*2\n        kMix3 = (kMorph-0.5)*2\n    endif\n    \n    aMix = aSaw*kMix1 + aSquare*kMix2 + aSine*kMix3\n    \n    outs aMix, aMix\nendin\n\ninstr 7\n    ; Harmonic tremolo (individual harmonic modulation)\n    iAmp = 0.25\n    iFreq = p4\n    \n    ; Each harmonic has different tremolo rate\n    kTrem1 poscil 0.3, 4, giSine\n    kTrem1 = 0.7 + kTrem1\n    \n    kTrem2 poscil 0.3, 5.5, giSine, 0.25\n    kTrem2 = 0.7 + kTrem2\n    \n    kTrem3 poscil 0.3, 7, giSine, 0.5\n    kTrem3 = 0.7 + kTrem3\n    \n    kTrem4 poscil 0.3, 8.5, giSine, 0.75\n    kTrem4 = 0.7 + kTrem4\n    \n    a1 poscil iAmp*kTrem1, iFreq*1, giSine\n    a2 poscil iAmp*0.7*kTrem2, iFreq*2, giSine\n    a3 poscil iAmp*0.5*kTrem3, iFreq*3, giSine\n    a4 poscil iAmp*0.3*kTrem4, iFreq*4, giSine\n    \n    aMix = (a1 + a2 + a3 + a4) * 0.5\n    \n    outs aMix, aMix\nendin\n\ninstr 8\n    ; Additive pad with chorus\n    iAmp = 0.2\n    iFreq = p4\n    \n    ; Multiple detuned layers of harmonics\n    ; Layer 1 (center)\n    a11 poscil iAmp*0.5, iFreq*1, giSine\n    a12 poscil iAmp*0.3, iFreq*2, giSine\n    a13 poscil iAmp*0.2, iFreq*3, giSine\n    \n    ; Layer 2 (slightly sharp)\n    a21 poscil iAmp*0.5, iFreq*1.005, giSine\n    a22 poscil iAmp*0.3, iFreq*2.005, giSine\n    a23 poscil iAmp*0.2, iFreq*3.005, giSine\n    \n    ; Layer 3 (slightly flat)\n    a31 poscil iAmp*0.5, iFreq*0.995, giSine\n    a32 poscil iAmp*0.3, iFreq*1.995, giSine\n    a33 poscil iAmp*0.2, iFreq*2.995, giSine\n    \n    aLeft = (a11 + a12 + a13 + a21 + a22 + a23) * 0.4\n    aRight = (a11 + a12 + a13 + a31 + a32 + a33) * 0.4\n    \n    outs aLeft, aRight\nendin\n\n</CsInstruments>\n<CsScore>\n\n; Play additive organ\ni1 0 4 220\ni1 4.5 4 330\n\n; Play spectral shimmer\ni2 9.5 5 196\n\n; Play bell-like\ni3 15.5 4 523\ni3 19.5 4 440\n\n; Play formant shifting\ni4 24.5 4 165\n\n; Play phase modulation\n; Format: start dur carrier mod_ratio\ni5 29.5 3 220 2\ni5 32.5 3 330 1.5\n\n; Play morphing wavetable\ni6 36.5 5 294\n\n; Play harmonic tremolo\ni7 42.5 4 392\n\n; Play additive pad\ni8 47.5 5 165\n\ne\n</CsScore>\n</CsoundSynthesizer>"}
